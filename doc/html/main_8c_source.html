<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>simulation_urgences:  Fichier source de G:/TC02/NF05/PROJET/simulation_urgences/main.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="R9a9e6c9ad22a3ccc249e2ebf10d5d697.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">simulation_urgences
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Simulation d&#39;un flux de patients au sein d&#39;un service d&#39;urgences.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Recherche');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">G:/TC02/NF05/PROJET/simulation_urgences/main.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="main_8c.html">Aller à la documentation de ce fichier.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//Temps pour concevoir le main : à peu près 25h (2h sur les options, 5h sur la création de patients,  6h sur le flux, 5h sur les statistiques, 2h sur l&#39;historique, 2h sur l&#39;optimisation de l&#39;affichage, 3h de debuggage et peaufinage )</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="salles_8h.html">salles.h</a>&quot;</span><span class="comment">/*Les différents fichiers headers sont imbriqués les uns dans les autres pour éviter les définitions multiples des fonctions.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">L&#39;ordre est le suivant : salles.h &gt; queue.h &gt; patient.h &gt; aleatoire.h &gt; temps.h. Headerception*/</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *chaine);</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keywordtype">char</span> <a class="code" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a>(<span class="keywordtype">char</span> c);</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keywordtype">char</span> <a class="code" href="main_8c.html#a8c2aa30c45c2b133140df33e611c7b3f">convertir_majuscules</a>(<span class="keywordtype">char</span> c);</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keywordtype">void</span> <a class="code" href="main_8c.html#a08cbd6d7992729766554608cd096e237">saisirstring</a>(<span class="keywordtype">char</span>* chaine) ;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="main_8c.html#aa9520464888562b1b4662795aac065dc">sauterligne</a>(<span class="keywordtype">bool</span> sauter_une_ligne) ;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(<span class="keywordtype">bool</span> sauter,<a class="code" href="structtemps.html">temps</a> t,<span class="keywordtype">char</span> *descriptif,<span class="keywordtype">char</span> *message_salle,FILE *f);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97">   32</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    srand(time(NULL));<span class="comment">//initialisation de rand avec pour seed l&#39;heure système pour avoir des générations différentes à chaque lancement</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordtype">bool</span> reafficher_menu=<span class="keyword">false</span>; <span class="comment">//booléen utilisé pour réafficher ou quitter des menus.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keywordtype">bool</span> saisie_correcte = <span class="keyword">false</span>; <span class="comment">//booléen utilisé pour gérer les erreurs de saisie de l&#39;utilisateur.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keywordtype">char</span> requete; <span class="comment">//caractère utilisé pour lire les commandes saisies par l&#39;utilisateur.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="structpatient.html">patient</a>* *liste_patients; <span class="comment">//déclaration d&#39;un tableau de (patient*)</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="structtemps.html">temps</a> temps_simulation;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//Declaration des différentes salles et boxs. Ils seront instanciés avant le flux de patients.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="struct_queue.html">Queue</a> *ENTREE;<a class="code" href="struct_queue.html">Queue</a> *SORTIE;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="structsalle__dattente.html">salle_dattente</a> *SDA1,*SDA2,*SDA3,*SDA4;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <a class="code" href="structsalle__even.html">salle_even</a> *S_ENREG,*S_EXAMEN_IOA,*S_EXAMEN_LONG,*S_EXAMEN_COURT,*S_EXAMEN_CPT;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="structsalle__even.html">salle_even</a> *BOX1,*BOX2,*BOX3, *BOX4, *BOX5,*BOX_CPT1,*BOX_CPT2;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">//Declaration de tableaux groupant les salles de même type.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="structsalle__dattente.html">salle_dattente</a>* tableau_salles_attente[4];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="structsalle__even.html">salle_even</a>* tableau_salles_even[5];</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">//DEBUT DE L&#39;INTERACTION</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    puts(<span class="stringliteral">&quot;Bienvenue dans ce logiciel de simulation de service des urgences.\n&quot;</span>);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">bool</span> quitter=!<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;Souhaitez-vous demarrer une simulation ?&quot;</span>); <span class="comment">//invite l&#39;utilisateur à commencer une première simulation ou à quitter directement le programme.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keywordflow">while</span>(!quitter) {<span class="comment">//Boucle dont chaque tour correspond à une nouvelle simulation indépendante des autres.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">int</span> nombre_patients=0; <span class="comment">//initialisation du nombres de patients à 0.</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    liste_patients=(<a class="code" href="structpatient.html">patient</a>**)malloc(<span class="keyword">sizeof</span>(<a class="code" href="structpatient.html">patient</a>*)); <span class="comment">//allocation d&#39;un espace mémoire pouvant stocker un ptr vers un patient. On utilisera realloc à pour s&#39;adapter au nombre de patients simulés et stocker autant de pointeurs vers des patients qu&#39;il le faudra.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">//REGLAGES</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">bool</span> options; <span class="comment">//conditionne l&#39;affichage ou non du menu des options</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordtype">bool</span> modifier_t=<span class="keyword">false</span>; <span class="comment">//permet la modification des paramètres temporels</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordtype">bool</span> un_seul_mois=<span class="keyword">true</span>; <span class="comment">//fixe le mois de la simulation. Activé par défaut.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span> annee_fixe; <span class="comment">//L&#39;année et le mois fixés devront alors être renseignés au moins une fois par l&#39;utilisateur.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> mois_fixe;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                <span class="keywordtype">bool</span> un_seul_jour=<span class="keyword">true</span>;<span class="comment">//le mode jour fixe est activé par défaut, mais on peut le désactiver dans le menu des options. Il permet d&#39;éviter d&#39;avoir à saisir plusieurs fois la date si on veut faire arriver tous les patients le même jour</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> jour_fixe;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordtype">bool</span> choisir_circuit=<span class="keyword">false</span>; <span class="comment">//par défaut : circuit déterminé aléatoirement. Modifiable dans le menu des options pour que l&#39;utilisateur puisse choisir le circuit de chaque patient.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordtype">bool</span> generation_patients_auto = <span class="keyword">true</span>; <span class="comment">//par défaut : patients générés automatiquement. Modifiable dans le menu des options pour que l&#39;utilisateur puisse créer ses propres patients, choisir leur nom et leur heure d&#39;arrivée.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordtype">bool</span> generation_durees_auto = <span class="keyword">true</span>; <span class="comment">//par défaut : durées générées automatiquement. Modifiable dans le menu des options pour que l&#39;utilisateur puisse choisir des durées opératoires à chaque événement du flux.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordtype">char</span> beep=<span class="charliteral">&#39;\a&#39;</span>; <span class="comment">//par défaut : bip sonore dépendant de l&#39;OS de l&#39;utilisateur joué à chaque étape de la simulation. Comme ça peut être casse-...pieds, surtout sur Windows, on peut le désactiver dans les options en le remplaçant par &#39;\0&#39;</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordtype">char</span> msg_options[300]=<span class="stringliteral">&quot;&quot;</span>; <span class="comment">//Message correspondant à la liste des options choisies pour informer l&#39;utilisateur des modalités de sa simulation.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <span class="comment">//PARAMETRES DE LA SIMULATION</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        options=!<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;Souhaitez-vous utiliser les parametres par defaut ?&quot;</span>); <span class="comment">//Si non, on va entrer dans le menu des options (vrai). Si non, on garde les options par défaut et on passe le menu (faux).</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="keywordflow">if</span> (options) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">//Permet a l&#39;utilisateur de regler les parametres de la simulation : mois fixé (par défaut), jour fixé, probabilites ou temps saisi a la main ...</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="keywordflow">do</span> {<span class="comment">//Cette première boucle do{instructions...}while(reafficher_menu); permet d&#39;inviter l&#39;utilisateur à saisir de nouvelles commandes tant qu&#39;il n&#39;a pas lancé sa simulation. Il peut ainsi modifier ses options à volonté et revenir sur ses choix.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            printf(<span class="stringliteral">&quot;\nMENU DES OPTIONS :\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            puts(<span class="stringliteral">&quot;Saisissez l&#39;une des commandes suivantes :&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;t&#39; pour modifier les parametres temporels de la simulation&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;p&#39; pour modifier le mode de generation des patients&quot;</span>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;d&#39; pour modifier le mode de generation des durees des taches&quot;</span>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;c&#39; pour modifier le mode de determination des circuits empruntes par les patients&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;b&#39; pour activer ou desactiver les tonalites sonores&quot;</span>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;s&#39; pour lancer la simulation&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <span class="comment">//On traitera chaque saisie de l&#39;utilisateur dans une structure de contrôle de type switch(...){case:...} avec un cas par défaut correspondant à la saisie d&#39;une commande inconnue.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            <span class="keywordflow">do</span> {<span class="comment">//On invitera à saisir de nouveau sa commande en cas de saisie incorrecte. La boucle de type do{instructions...}while(!saisie_correcte) éxécute une première fois ses instructions avant de vérifier si la saisie est correcte.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                <span class="comment">/*Les différents booléens correspondant aux options choisies sont affectés grâce à la fonction yesno_question définie dans le main.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">                Elle affiche une question, invite à la saisie sécurisé d&#39;un caractère &#39;o&#39; ou &#39;n&#39; et le convertit en booléen &#39;vrai&#39; ou &#39;faux&#39;, dont la valeur peut être inversée si besoin est.*/</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                fflush(stdin); <span class="comment">//fflush(stdin) permet de &#39;nettoyer&#39; la console pour éviter de consommer des caractères excédentaires à la prochaine saisie.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                scanf(<span class="stringliteral">&quot; %c&quot;</span>,&amp;requete);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                requete = <a class="code" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a>(requete);<span class="comment">//On convertit requete en caractère minuscule (grâce à une fonction définie dans main.c) pour rendre la saisie insensible à la casse.</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">switch</span>(requete) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span> :</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    un_seul_mois=<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\tVoulez-vous que la simulation couvre un seul mois ?&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    <span class="comment">//cette option permet d&#39;éviter d&#39;avoir à taper la date entière lorsque tous les patients arrivent le même mois.  ACTIVEE PAR DEFAUT</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                    un_seul_jour=<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\tVoulez-vous que la simulation couvre un seul jour ?&quot;</span>);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                    <span class="comment">//avec cette option, on ne demandera que l&#39;heure d&#39;arrivée pour chaque patient.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    modifier_t=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                    reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span> :</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    generation_patients_auto=!<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\tSouhaitez-vous creer les patients manuellement ?&quot;</span>);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                    reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span> :</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    generation_durees_auto=!<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\tSouhaitez-vous choisir manuellement les durees des taches pour chaque patient ?&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span> :</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    choisir_circuit=<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\tVoulez-vous choisir manuellement le circuit emprunte par chaque patient ?&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                    reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;b&#39;</span>:</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    beep=(<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\tSouhaitez-vous couper le son du programme ?&quot;</span>))?<span class="charliteral">&#39;\0&#39;</span>:<span class="charliteral">&#39;\a&#39;</span>;<span class="comment">//Si l&#39;utilisateur répond &#39;o&#39;, le caractère beep prend la valeur &#39;\0&#39; au lieu de &#39;\a&#39; et le programme devient silencieux.</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span> :</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    reafficher_menu=<span class="keyword">false</span>; <span class="comment">//On arrête de reafficher le menu des options : on passe à la suite.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                    default : <span class="comment">//gestion du cas où l&#39;utilisateur saisit une commande inconnue</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    puts(<span class="stringliteral">&quot;Saisie incorrecte. Veuillez reessayer :&quot;</span>);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            }<span class="keywordflow">while</span>(!saisie_correcte);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        }<span class="keywordflow">while</span>(reafficher_menu);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        reafficher_menu=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        printf(<span class="stringliteral">&quot;_____________________________________________________________________________________\n&quot;</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">//Remplissage de la chaîne msg_options en fonction des options choisies pour informer l&#39;utilisateur des modalités de la simulation.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        strcat(msg_options,<span class="stringliteral">&quot;\nCONFIGURATION : &quot;</span>);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span>(un_seul_jour&amp;&amp;!choisir_circuit&amp;&amp;generation_durees_auto&amp;&amp;generation_patients_auto&amp;&amp;beep==<span class="charliteral">&#39;\a&#39;</span>) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;DEFAUT\n&quot;</span>);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;PERSONNALISEE\n&quot;</span>);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        }</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        strcat(msg_options,<span class="stringliteral">&quot;\tGeneration des patients : &quot;</span>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">if</span>(generation_patients_auto) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;AUTO\n&quot;</span>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;MANUELLE\n&quot;</span>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        strcat(msg_options,<span class="stringliteral">&quot;\tGeneration des durees : &quot;</span>);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span>(generation_durees_auto) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;AUTO\n&quot;</span>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;MANUELLE\n&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        strcat(msg_options,<span class="stringliteral">&quot;\tDetermination du circuit : &quot;</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">if</span>(choisir_circuit) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;AUTO\n&quot;</span>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;MANUELLE\n&quot;</span>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        strcat(msg_options,<span class="stringliteral">&quot;\tLimitations temporelles : &quot;</span>);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">if</span>(un_seul_jour) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;JOUR\n&quot;</span>);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(un_seul_mois) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;MOIS\n&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;SANS\n&quot;</span>);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        strcat(msg_options,<span class="stringliteral">&quot;\tBip sonore horripilant : &quot;</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="keywordflow">if</span>(beep==<span class="charliteral">&#39;\a&#39;</span>) {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;AVEC\n&quot;</span>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            strcat(msg_options,<span class="stringliteral">&quot;SANS\n&quot;</span>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        printf(<span class="stringliteral">&quot;%s&quot;</span>,msg_options); <span class="comment">//Affichage de la chaîne msg_options</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        putchar(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordtype">int</span> nb_patients_cc=0; <span class="keywordtype">int</span> nb_patients_cl=0;<span class="keywordtype">int</span> nb_patients_cl_cpt=0; <span class="comment">//initialisation des nombres de patients passant par chaque circuit.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">//AJOUT DES PATIENTS</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        printf(<span class="stringliteral">&quot;\nGENERATION DES PATIENTS :\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <a class="code" href="structtemps.html">temps</a> temps_temporaire; <span class="comment">//détermination des données temporelles fixes qui ne seront pas redemandées à l&#39;utilisateur.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="keywordflow">if</span>(un_seul_mois&amp;&amp;!un_seul_jour) {<span class="comment">//Si on est en mode mois fixé (sans que le jour soit aussi fixé), on demande le mois et l&#39;année à l&#39;utilisateur.</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    puts(<span class="stringliteral">&quot;Mois et annee d&#39;arrivee des patients :&quot;</span>);</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    temps_temporaire=<a class="code" href="temps_8c.html#a392a56219736519e5abb210ad9f67383">demander_annee_mois</a>();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    annee_fixe = temps_temporaire.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    mois_fixe = temps_temporaire.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">if</span>(un_seul_jour) {<span class="comment">//activé par défaut : mode jour fixé</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                    puts(<span class="stringliteral">&quot;Date d&#39;arrivee des patients :&quot;</span>);</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                    <a class="code" href="structtemps.html">temps</a> temps_temporaire;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                    temps_temporaire=<a class="code" href="temps_8c.html#a8eef0f9e961c61abc041d51a6e68dc07">demander_date</a>(); <span class="comment">//On demande la date d&#39;arrivée des patients à l&#39;utilisateur. (la simulation pourra tout de même s&#39;étendre au delà de cette date).</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    annee_fixe = temps_temporaire.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    mois_fixe = temps_temporaire.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                    jour_fixe = temps_temporaire.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span>(!generation_patients_auto){<span class="comment">//création des patients en mode manuel</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            puts(<span class="stringliteral">&quot;\nVeuillez entrer a la suite les informations demandees pour chaque patient\n\n&quot;</span>);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="comment">//proposition de débloquage du mode mois fixé si on arrive à la fin du mois (ex : 31/12)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordflow">if</span>((nombre_patients&gt;0)&amp;&amp;<a class="code" href="temps_8c.html#aae393b86938adce806d3b2d3eadc1502">estDernierJourMois</a>(liste_patients[nombre_patients-1]-&gt;arrivee)&amp;&amp;(un_seul_mois||un_seul_jour)) {<span class="comment">//Si un patient est arrivé tard le dernier jour du mois, on propose à l&#39;utilisateur de désactiver les modes jour fixe et mois fixe pour ajouter des patients le lendemain.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\nLe dernier patient arrive le dernier jour du mois.\nVoulez-vous permettre a la simulation de s&#39;etendre sur plus d&#39;un mois ?&quot;</span>))</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        un_seul_mois=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                        un_seul_jour=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    puts(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                liste_patients=realloc(liste_patients,(nombre_patients+1)*<span class="keyword">sizeof</span>(<a class="code" href="structpatient.html">patient</a>*)); <span class="comment">//Réallocation dynamique de la mémoire : à chaque nouveau patient ajouté par l&#39;utilisateur, on augmente de (sizeof(patient*)) la taille de l&#39;espace mémoire.</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <a class="code" href="structpatient.html">patient</a> *patient_temporaire = <a class="code" href="patient_8c.html#a872f83f436fc70d41fdf37405165d107">creerPatient</a>(); <span class="comment">//La fonction creerPatient (patient.c) instancie un patient en lui réservant un espace mémoire. On utilise une variable intermédiaire patient_temporaire pour le manipuler.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                printf(<span class="stringliteral">&quot;\tNouveau patient (%d au total) :\n&quot;</span>,nombre_patients);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="comment">//on demande le nom et le prenom du patient</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                printf(<span class="stringliteral">&quot;Prenom : &quot;</span>);<a class="code" href="main_8c.html#a08cbd6d7992729766554608cd096e237">saisirstring</a>(patient_temporaire-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>);<span class="comment">//La fonction saisirstring permet la saisie sécurisée d&#39;une chaîne de caractères contenant des espaces</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                printf(<span class="stringliteral">&quot;Nom : &quot;</span>); <a class="code" href="main_8c.html#a08cbd6d7992729766554608cd096e237">saisirstring</a>(patient_temporaire-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="comment">/*on demande la date et l&#39;heure d&#39;arrivée selon les paramètres de la simulation (en mode génération manuelle des patients, c&#39;est l&#39;utilisateur qui choisit leur date d&#39;arrivée).</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">                Les fonctions de saisie de temps associées sont définies dans temps.c*/</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="keywordflow">if</span>(!un_seul_mois&amp;&amp;!un_seul_jour) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                    printf(<span class="stringliteral">&quot;Date et heure d&#39;arrivee au service des urgences : \n&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    patient_temporaire-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>=<a class="code" href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a>();</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(un_seul_mois&amp;&amp;!un_seul_jour) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    printf(<span class="stringliteral">&quot;Jour et heure d&#39;arrivee au service des urgences : \n&quot;</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    patient_temporaire-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>=<a class="code" href="temps_8c.html#ab54a9d70f29755a3868cf6df238cff73">demander_jour_heure</a>(annee_fixe,mois_fixe);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    patient_temporaire-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                    patient_temporaire-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                }</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(un_seul_jour) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                    printf(<span class="stringliteral">&quot;Heure d&#39;arrivee au service des urgences : \n&quot;</span>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    patient_temporaire-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>=<a class="code" href="temps_8c.html#a3eb0b4e2216d80cb4b835c3e7ef6955b">demander_heure</a>();</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    patient_temporaire-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    patient_temporaire-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    patient_temporaire-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>=jour_fixe;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="keywordflow">if</span>(!choisir_circuit) {<span class="comment">//Si le mode &quot;choix automatique du circuit est activé...</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    <span class="keywordflow">if</span>(!generation_durees_auto) {<span class="comment">//et le mode &quot;génération manuelle des durées opératoires&quot; est aussi activé, on demande la durée de l&#39;examen complémentaire pour chaque patient au cas où il y serait admis (c&#39;est dans les consignes du sujet).</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                        printf(<span class="stringliteral">&quot;Duree de l&#39;examen complementaire : \n&quot;</span>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                        patient_temporaire-&gt;<a class="code" href="structpatient.html#a595b073371fbe81581c391db3899dc15">duree_examen_complementaire</a>=<a class="code" href="temps_8c.html#a805f024985dcaa7a6bec43095d8990a9">demander_duree</a>();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="keywordflow">else</span> {<span class="comment">//Sinon, le mode &quot;choix manuel du circuit&quot; est activé, on demande à l&#39;utilisateur de choisir un circuit pour son patient.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                    printf(<span class="stringliteral">&quot;\tCircuit emprunte par le patient (c/l) : &quot;</span>);</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    requete=0;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    <span class="keywordflow">do</span>{</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                        fflush(stdin);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        scanf(<span class="stringliteral">&quot; %c&quot;</span>,&amp;requete);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                        requete=<a class="code" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a>(requete);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                        <span class="keywordflow">switch</span>(requete) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                            <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:<span class="comment">//L&#39;utilisateur a choisi le circuit court pour son patient.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                            patient_temporaire-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>=<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ae245e90149daf6036ece3cb84960aab1">COURT</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                            saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                            nb_patients_cc++;<span class="comment">//On incrémente le nombre de patients passant en circuit court.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                            <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:<span class="comment">//L&#39;utilisateur a choisi le circuit long pour son patient.</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                            patient_temporaire-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>=(<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\tLe patient necessite-t-il un examen complementaire ?&quot;</span>))?<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a>:<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ab86309467500740b6a45155702e36424">LONG_SIMPLE</a>;<span class="comment">//On demande à l&#39;utilisateur s&#39;il veut diriger son utilisateur vers la salle d&#39;examens complémentaires ou non.</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                            <span class="keywordflow">if</span>(patient_temporaire-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>==<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a>) {<span class="comment">//L&#39;utilisateur a choisi le circuit long avec examen complémentaire.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                                <span class="keywordflow">if</span>(!generation_durees_auto) {<span class="comment">//Si le mode &quot;génération manuelle des durées&quot; est activé, on demande de renseigner la durée de l&#39;examen complémentaire.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                    printf(<span class="stringliteral">&quot;\tDuree de l&#39;examen complementaire : \n&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                    patient_temporaire-&gt;<a class="code" href="structpatient.html#a595b073371fbe81581c391db3899dc15">duree_examen_complementaire</a>=<a class="code" href="temps_8c.html#a805f024985dcaa7a6bec43095d8990a9">demander_duree</a>();</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                nb_patients_cl_cpt++;<span class="comment">//On incrémente le nombre de patients admis en examens complémentaires</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                            }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                            saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                            nb_patients_cl++;<span class="comment">//On incrémente le nombre de patients passant par le circuit long.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                            <span class="keywordflow">default</span>: <span class="comment">//cas où le caractère saisi est inattendu. On demande alors une nouvelle saisie en rebouclant.</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                            saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                        }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    }<span class="keywordflow">while</span>(!saisie_correcte);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                liste_patients[nombre_patients]=patient_temporaire;<span class="comment">//Ajout du patient au tableau contenant tous les patients de la simulation.</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                nombre_patients++;<span class="comment">//Incrémentation du nombre de patients.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            <span class="keywordflow">while</span>(<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\nVoulez-vous ajouter un nouveau patient ?&quot;</span>));<span class="comment">//On invite l&#39;utilisateur à saisir ou non un nouveau patient. Cette manière de faire évite de demander un nombre de patients à l&#39;utilisateur.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">else</span> { <span class="comment">//si les patients sont génerés automatiquement et non manuellement</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment">/*La génération des instants d&#39;arrivée nécessite la définition d&#39;une plage horaire avec un début et une fin et d&#39;un nombre de patients.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">            On va créer deux variables temps correspondant aux limites de la plage horaire et les affecter en fonction des options de la simulation.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            <a class="code" href="structtemps.html">temps</a> debut_plage_horaire_arrivee;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <a class="code" href="structtemps.html">temps</a> fin_plage_horaire_arrivee;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="keywordflow">if</span>(!un_seul_mois&amp;&amp;!un_seul_jour) { <span class="comment">//Aucun paramètre temporels fixés, on demande la date et l&#39;heure de début et de fin d&#39;arrivée des patients.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    printf(<span class="stringliteral">&quot;Date et heure de debut de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    debut_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a>();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    printf(<span class="stringliteral">&quot;Fin de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a>();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    <span class="keywordflow">while</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(fin_plage_horaire_arrivee,debut_plage_horaire_arrivee)!=1){ <span class="comment">//Comparaison de l&#39;instant de fin et de début. Si l&#39;instant de fin d&#39;arrivée des patients est antérieur ou égal à l&#39;instant de début, il faut le saisir de nouveau.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        printf(<span class="stringliteral">&quot;Plage horaire incorrecte. Veuillez saisir la date fin de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a>();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(un_seul_mois&amp;&amp;!un_seul_jour) {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    printf(<span class="stringliteral">&quot;Jour et heure de debut de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    debut_plage_horaire_arrivee=<a class="code" href="temps_8c.html#ab54a9d70f29755a3868cf6df238cff73">demander_jour_heure</a>(annee_fixe,mois_fixe);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    debut_plage_horaire_arrivee.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    debut_plage_horaire_arrivee.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    printf(<span class="stringliteral">&quot;Fin de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                     <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#aae393b86938adce806d3b2d3eadc1502">estDernierJourMois</a>(debut_plage_horaire_arrivee)) {<span class="comment">//permet de désactiver le mode &quot;mois fixé&quot; si l&#39;arrivée des patients commence tard le dernier jour du mois.</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                            <span class="keywordflow">if</span>(<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\nLa simulation commence a la fin du mois. Souhaitez-vous desactiver le mode \&quot;mois fixe\&quot; ?&quot;</span>)) {</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                un_seul_mois=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                                un_seul_jour=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                printf(<span class="stringliteral">&quot;Fin de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a>(); <span class="comment">//On demandera alors la date et l&#39;heure au complet.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                puts(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                            }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                        }</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                        fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#ab54a9d70f29755a3868cf6df238cff73">demander_jour_heure</a>(annee_fixe,mois_fixe);<span class="comment">//On ne demande que le jour et l&#39;heure d&#39;arrivée des patients en mode &quot;mois fixé&quot;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                        fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                    }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    <span class="keywordflow">while</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(fin_plage_horaire_arrivee,debut_plage_horaire_arrivee)!=1) {<span class="comment">//On vérifie ensuite que la plage horaire est correcte et on demande un nouvel instant de fin s&#39;il y a un problème, selon les paramètres temporels.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                            <span class="keywordflow">if</span>(debut_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>==fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>&amp;&amp;(un_seul_mois)){</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                                printf(<span class="stringliteral">&quot;Plage horaire incorrecte.Saisir l&#39;heure de fin de la plage horaire d&#39;arrivee des patients, le %02d/%02d/%04d :\n&quot;</span>,fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>,fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>,fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a3eb0b4e2216d80cb4b835c3e7ef6955b">demander_heure</a>();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                                fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>=jour_fixe;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                            }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(debut_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>&gt;=fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>&amp;&amp;(un_seul_mois)){</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                printf(<span class="stringliteral">&quot;Plage horaire incorrecte. Le jour de fin doit etre superieur au jour d&#39;arrivee.&quot;</span>);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#ab54a9d70f29755a3868cf6df238cff73">demander_jour_heure</a>(annee_fixe,mois_fixe);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                            }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!un_seul_mois){</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                printf(<span class="stringliteral">&quot;Plage horaire incorrecte. La fin doit etre posterieure au debut. Veuillez reessayer : \n&quot;</span>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                            }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(un_seul_jour) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    <a class="code" href="structtemps.html">temps</a> okazou;<span class="comment">//Si l&#39;heure est supérieure à 23:00, on désactivera le mode &quot;jour fixe&quot; pour permettre à l&#39;utilisateur de saisir une plage horaire potentiellement plus étendue au prix de la simplicité de saisie.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    printf(<span class="stringliteral">&quot;Heure de debut de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    debut_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a3eb0b4e2216d80cb4b835c3e7ef6955b">demander_heure</a>();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    debut_plage_horaire_arrivee.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    debut_plage_horaire_arrivee.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    debut_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>=jour_fixe;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    okazou = debut_plage_horaire_arrivee; okazou.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>=23;okazou.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>=00;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                    printf(<span class="stringliteral">&quot;Fin de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a3eb0b4e2216d80cb4b835c3e7ef6955b">demander_heure</a>();</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                    fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                    fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>=jour_fixe;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    <span class="keywordflow">while</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(fin_plage_horaire_arrivee,debut_plage_horaire_arrivee)!=1) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                        <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(okazou,debut_plage_horaire_arrivee)==0) { <span class="comment">//pour ne pas rester bloqué si on est en mode jour fixe et que l&#39;utilisateur a choisi l&#39;arrivee au delà de 23:00</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                            printf(<span class="stringliteral">&quot;\nLa simulation commence a la fin du jour. Desactivation du mode \&quot;jour fixe\&quot;.\n&quot;</span>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                            un_seul_mois=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                            un_seul_jour=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                            okazou.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>=0;okazou.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>=0;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                            printf(<span class="stringliteral">&quot;Fin de la plage horaire d&#39;arrivee des patients : \n&quot;</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                            fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a>();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                            puts(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                            <span class="keywordflow">if</span>(un_seul_jour){</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                                printf(<span class="stringliteral">&quot;Plage horaire incorrecte. L&#39;heure de fin doit etre superieure a l&#39;heure d&#39;arrivee. Veuillez reessayer : \n&quot;</span>);</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                                fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a3eb0b4e2216d80cb4b835c3e7ef6955b">demander_heure</a>();</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                                fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=annee_fixe;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=mois_fixe;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                fin_plage_horaire_arrivee.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>=jour_fixe;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                            }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                            <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                printf(<span class="stringliteral">&quot;Plage horaire incorrecte. La fin doit etre posterieure au debut. Veuillez reessayer : \n&quot;</span>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                fin_plage_horaire_arrivee=<a class="code" href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a>();</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                            }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                    }</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160; </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff = <a class="code" href="temps_8c.html#aca1b475930a200a027ff12bb4a2f5960">diffTemps_minutes</a>(debut_plage_horaire_arrivee,fin_plage_horaire_arrivee);<span class="comment">//Calcul de la plage horaire comme instant fin - instant début à l&#39;aide de la fonction diffTemps(temps t1, temps t2) définie dans temps.c.</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> inf_recommande=ceil(diff/50+sqrt(diff)/4); inf_recommande = (inf_recommande&gt;1000)?500:inf_recommande;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sup_recommande=ceil(5*sqrt(diff)+diff/50); sup_recommande = (sup_recommande&gt;1000)?1000:sup_recommande;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            printf(<span class="stringliteral">&quot;\nNombre de patients a simuler (recommande : %d &lt; nb &lt; %d) : &quot;</span>,inf_recommande,sup_recommande);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <span class="comment">/*les durées recommandées sont choisies de manière à permettre une simulation plus ou moins réaliste en permettant l&#39;arrivée d&#39;assez de patients pour créer des files d&#39;attente tout en</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">            évitant les trop grands nombres pour avoir des patients qui attendent 3 jours en salle d&#39;attente. La fonction racine carrée permet d&#39;avoir des nombres relativement grands pour des petites plages horaires</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">            et relativement petits pour les grandes plages horaires, puisqu&#39;on suppose que l&#39;utilisateur préférera simuler soit une petite plage horaire avec beaucoup de patients (heure de pointe)</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">            Soit une grande plage horaire avec un flux de patient normal, et il n&#39;a pas non plus envie que la simulation prenne trop de temps et soit trop longue.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;nombre_patients);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            <span class="keywordtype">bool</span> confirme = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;            <span class="keywordflow">while</span>(nombre_patients&gt;1000&amp;&amp;!confirme || nombre_patients&lt;1) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="keywordflow">if</span>(nombre_patients&gt;1000) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    confirme = <a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;C&#39;est beaucoup pour la memoire de l&#39;ordinateur, le programme risque de crasher. Continuer ? &quot;</span>); <span class="comment">/*On avertit l&#39;utilisateur que la simulation n&#39;a pas été conçue pour traiter de très grands nombres de patients.</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">                    Mais on peut saisir n&#39;importe quel nombre dans les limites de l&#39;unsigned short int, du moment que l&#39;on a assez de mémoire ça fonctionne.*/</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nombre_patients&lt;1) {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                    printf(<span class="stringliteral">&quot;Il faut au minimum un patient pour lancer la simulation. Veuillez de nouveau saisir le nombre de patinets a simuler : &quot;</span>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">if</span>(!confirme||nombre_patients&lt;1){</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;nombre_patients);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            confirme = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            liste_patients = <a class="code" href="patient_8c.html#a80e7249dcf2eace5c4978ab68b3714e0">genererPatients</a>(nombre_patients,debut_plage_horaire_arrivee,fin_plage_horaire_arrivee); <span class="comment">/*Utilisation de la fonction genererPatients (définie dans patient.c) pour :</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">            - instancier nombre_patients patients et les ajouter à un tableau de (patient*) que l&#39;on retourne</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">            - leur attribuer un id</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">            - leur attribuer une heure d&#39;arrivée en se basant sur un processus de poisson (appliqué par paquets de 22 patients - car factorielle(23) est un trop grand nombre pour l&#39;ordinateur) sélectionnant l&#39;instant avec la plus forte probabilité d&#39;arrivée du patient,</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">            influencé par une composante aléatoire pour éviter une répartition trop parfaite des patients (on souhaite que des patients puissent arriver en même temps et on ne veut pas qu&#39;il y ait presque toujours le même écart entre deux heures d&#39;arrivée)*/</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <a class="code" href="patient_8c.html#aec675c6b3fe32ec2a1cf9e7e20b1cd81">nommerPatients</a>(nombre_patients,liste_patients); <span class="comment">/*Utilisation de la fonction nommerPatients (définie dans patient.c) pour attribuer des noms indiqués dans un fichier (&quot;liste_noms.txt&quot;) à chaque *patient de liste_patients.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">            La fonction distribue aléatoirement ces noms et évite dans la mesure du possible la création de doublons.*/</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            <a class="code" href="structpatient.html">patient</a> *patient_temporaire;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            <span class="comment">//Gestion des modes automatiques/manuels déterminés dans les options</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="keywordflow">if</span>(!(generation_durees_auto&amp;&amp;!choisir_circuit)){<span class="comment">//Dans tous les cas, sauf celui où les durées sont générées automatiquement et où les circuits sont déterminés automatiquements aussi</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i&lt;nombre_patients ; i++) {<span class="comment">//On parcourt l&#39;ensemble de la liste de patients pour leur appliquer un traitement</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    patient_temporaire=liste_patients[i];</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    printf(<span class="stringliteral">&quot;Patient %d (%s %s) : \n&quot;</span>,patient_temporaire-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,patient_temporaire-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,patient_temporaire-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    <span class="keywordflow">if</span>(!choisir_circuit) {<span class="comment">//Si on est en mode détermination automatique des circuits...</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                            <span class="keywordflow">if</span>(!generation_durees_auto) {<span class="comment">//...avec en plus un choix manuel des durées des tâches</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                                printf(<span class="stringliteral">&quot;Duree de l&#39;examen complementaire : \n&quot;</span>);</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                                patient_temporaire-&gt;<a class="code" href="structpatient.html#a595b073371fbe81581c391db3899dc15">duree_examen_complementaire</a>=<a class="code" href="temps_8c.html#a805f024985dcaa7a6bec43095d8990a9">demander_duree</a>(); <span class="comment">//On demande la durée de l&#39;examen complémentaire de chaque patient généré (demandé dans les consignes du sujet)</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                            }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                        }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                    <span class="keywordflow">else</span> {<span class="comment">//choix manuel du circuit</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        <span class="comment">/*Détermination du circuit de chaque patient à l&#39;aide d&#39;une structure switch(...){case:...} imbriquée dans une boucle.</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">                        Orientation des patients vers le circuit court, long avec ou sans examen complémentaire, et incrémentation du compteur correspondant.*/</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                            printf(<span class="stringliteral">&quot;\tCircuit emprunte par le patient (c/l) : &quot;</span>);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                            saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                            requete=0;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                            <span class="keywordflow">do</span>{</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                fflush(stdin);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                scanf(<span class="stringliteral">&quot; %c&quot;</span>,&amp;requete);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                requete=<a class="code" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a>(requete);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                <span class="keywordflow">switch</span>(requete) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                    <span class="keywordflow">case</span> <span class="charliteral">&#39;c&#39;</span>:</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                    patient_temporaire-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>=<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ae245e90149daf6036ece3cb84960aab1">COURT</a>;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                    nb_patients_cc++;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                    <span class="keywordflow">case</span> <span class="charliteral">&#39;l&#39;</span>:</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                    patient_temporaire-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>=(<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\tLe patient necessite-t-il un examen complementaire ?&quot;</span>))?<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a>:<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ab86309467500740b6a45155702e36424">LONG_SIMPLE</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                    <span class="keywordflow">if</span>(patient_temporaire-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>==<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a>) {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                        <span class="keywordflow">if</span>(!generation_durees_auto) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                            printf(<span class="stringliteral">&quot;\tDuree de l&#39;examen complementaire : \r&quot;</span>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                                            patient_temporaire-&gt;<a class="code" href="structpatient.html#a595b073371fbe81581c391db3899dc15">duree_examen_complementaire</a>=<a class="code" href="temps_8c.html#a805f024985dcaa7a6bec43095d8990a9">demander_duree</a>();</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                        }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                                        nb_patients_cl_cpt++;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                    }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                    nb_patients_cl++;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                    saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                            }<span class="keywordflow">while</span>(!saisie_correcte);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                        }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                }</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">//DETERMINATION ALEATOIRE DES CIRCUITS (activé par défaut)</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">if</span>(!choisir_circuit) { <span class="comment">//Si le mode &quot;choix manuel des circuits&quot; est désactivé (par défaut)</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            <span class="keywordtype">int</span> p;<span class="comment">//On va générer un entier entre 0 et 99.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nombre_patients; i++) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                p = rand() % 100; <span class="comment">/*à l&#39;aide du générateur de nombres pseudo-aléatoires rand(), on génère pour chaque patient un entier compris entre 0 et 99 sur la base de la seed correspondant au temps machine au lancement du programme.</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">                S&#39;il est inférieur à 40, on attribuera au patient le circuit court (40% de chance pour un patient d&#39;être orienté en CC).</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">                Sinon, il est orienté en circuit long. */</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <span class="keywordflow">if</span>(p&lt;40)  { <span class="comment">//p est inférieur à 40 donc compris entre 0 et 39 : 40 valeurs possibles sur 100 au total soit 40% de chance que cette condition soit élue : le patients ira en circuit court</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    liste_patients[i]-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>=<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ae245e90149daf6036ece3cb84960aab1">COURT</a>; <span class="comment">//Attribution de la valeur COURT (valeur possible parmi l&#39;enum circuit) au champ circuit(caractère) du patient.</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    nb_patients_cc++;<span class="comment">//Incrémentation du compteur de patients entrés en circuit court.</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                <span class="keywordflow">else</span> {<span class="comment">//Si p&gt;= 40, alors p est compris entre 40 et 99 (60 valeurs possibles sur 100 au total) : le patient sera orienté vers le circuit long.(60% de chance)</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                    p = rand() % 100;<span class="comment">//On génère un autre nombre pseudo aléatoire entre 0 et 99 déterminant l&#39;admission ou non à des examens complémentaires.</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                    <span class="keywordflow">if</span>(p&lt;80) { <span class="comment">//80% de chance de valider cette condition. Patient orienté vers la salle d&#39;examens complémentaires.</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                        liste_patients[i]-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>=<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a>;<span class="comment">//On attribue à liste_patient[i]-&gt;circuit la valeur LONG_EXAM_CPT de l&#39;enum circuit.</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        nb_patients_cl_cpt++; <span class="comment">//On incrémente le nombre de patients allant en examen complémentaire.</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                    }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    <span class="keywordflow">else</span> {<span class="comment">//20% de chance de valider cette condition. Patient libéré après son premier examen.</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                        liste_patients[i]-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>=<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ab86309467500740b6a45155702e36424">LONG_SIMPLE</a>;<span class="comment">//On attribue à liste_patient[i]-&gt;circuit la valeur LONG_EXAM_SIMPLE de l&#39;enum circuit.</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                    }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    nb_patients_cl++; <span class="comment">//Dans les deux cas, le compteur de patients du circuit long est incrémenté.</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                }</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;         printf(<span class="stringliteral">&quot;\nDEBUT DE LA SIMULATION :\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <span class="comment">//CREATION DES SALLES (à l&#39;aide de fonctions d&#39;instanciation définies dans queue.c et salles.c). Les variables suivantes contiennent des POINTEURS vers des structures de type Queue, salle_dattente et salle_even</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        ENTREE = <a class="code" href="queue_8c.html#a768e29a4a002f3c86c06bdbf7420be38">trierPatients</a>(nombre_patients,liste_patients); <span class="comment">//on créée une queue qui contient tous les patients dans l&#39;ordre où ils arrivent. La fonction trierPatients de queue.c trie un tableau (patient**) par heures d&#39;arrivée croissantes et créée une queue correspondante</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        SORTIE = <a class="code" href="queue_8c.html#a8754fb0edc8076afe6b6e76995a43c60">creerQueue</a>(nombre_patients); <span class="comment">//La queue de sortie est simplement instanciée (fonction créerQueue de queue.c). Son tableau SORTIE-&gt;elements (patient**) sera de taille nombre_patients car tous les patients vont sortir.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        SDA1 = <a class="code" href="salles_8c.html#ab31ca02a82373fd0c38b7dc765017f76">creerSalleDattente</a>(nombre_patients,<span class="stringliteral">&quot;salle d&#39;attente 1&quot;</span>);<span class="comment">//instanciation d&#39;une salle d&#39;attente. SDA1-&gt;QUEUE contiendra un ptr vers une queue de taille nombre_patients. Son message sera &quot;salle d&#39;attente1&quot;. Le temps d&#39;atttente sera initialisé à un temps nul.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        SDA2 = <a class="code" href="salles_8c.html#ab31ca02a82373fd0c38b7dc765017f76">creerSalleDattente</a>(nombre_patients,<span class="stringliteral">&quot;salle d&#39;attente 2&quot;</span>);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        S_ENREG=<a class="code" href="salles_8c.html#a647c9b0bb00267b3c8220f143f1892f4">creerSalleEven</a>(<span class="stringliteral">&quot;salle d&#39;enregistrement&quot;</span>,SDA1,SDA2,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nombre_patients,3,2,NULL,0);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <span class="comment">/*Explication : création d&#39;une salle_even à l&#39;aide d&#39;une fonction définie dans salles.c : descriptif =&quot;salle d&#39;enregistrement&quot;,salle_prec=SDA1,salle_suiv=SDA2,nb patients = nombre_patients,</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">        duree(esperance) : 3, duree(ecart) : 2 (donc durées comprises entre 1 et 5 minutes), groupement de boxs : NULL, nombre de boxs : 0*/</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        S_EXAMEN_IOA=<a class="code" href="salles_8c.html#a647c9b0bb00267b3c8220f143f1892f4">creerSalleEven</a>(<span class="stringliteral">&quot;salle d&#39;examen IOA&quot;</span>,SDA2,NULL,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nombre_patients,6,3,NULL,0);<span class="comment">/*on choisit une durée moyenne de 6 minutes, +- 3 minutes pour l&#39;examen ioa.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">        La salle suivante n&#39;est pas prédéterminée, elle sera modifiée selon le circuit emprunté par les patients*/</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        SDA3 = <a class="code" href="salles_8c.html#ab31ca02a82373fd0c38b7dc765017f76">creerSalleDattente</a>(nb_patients_cl,<span class="stringliteral">&quot;salle d&#39;attente 3&quot;</span>); <span class="comment">//la taille des queues de SDA3 et SDA4 correspond au nombre de patients empruntant chaque circuit.</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        SDA4 = <a class="code" href="salles_8c.html#ab31ca02a82373fd0c38b7dc765017f76">creerSalleDattente</a>(nb_patients_cc,<span class="stringliteral">&quot;salle d&#39;attente 4&quot;</span>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        BOX1 = <a class="code" href="salles_8c.html#a3c356fda632f22019265eb76e6f11cdf">creerBox</a>(<span class="stringliteral">&quot;box 1&quot;</span>) ; BOX2 = <a class="code" href="salles_8c.html#a3c356fda632f22019265eb76e6f11cdf">creerBox</a>(<span class="stringliteral">&quot;box 2&quot;</span>) ; BOX3 = <a class="code" href="salles_8c.html#a3c356fda632f22019265eb76e6f11cdf">creerBox</a>(<span class="stringliteral">&quot;box 3&quot;</span>) ; BOX4 = <a class="code" href="salles_8c.html#a3c356fda632f22019265eb76e6f11cdf">creerBox</a>(<span class="stringliteral">&quot;box 4&quot;</span>); BOX5 = <a class="code" href="salles_8c.html#a3c356fda632f22019265eb76e6f11cdf">creerBox</a>(<span class="stringliteral">&quot;box 5&quot;</span>);<span class="comment">//instanciation des boxs. (creerBox(const char* message) est définie dans salles.c)</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        S_EXAMEN_LONG=<a class="code" href="salles_8c.html#a647c9b0bb00267b3c8220f143f1892f4">creerSalleEven</a>(<span class="stringliteral">&quot;salle d&#39;examens (circuit long)&quot;</span>,SDA3,NULL,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nb_patients_cl,45,20,<a class="code" href="salles_8c.html#abdfaefa1a2ae1288d772d48efc21d02c">grouperBoxs</a>(3,BOX1,BOX2,BOX3),3);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="comment">/*Explications : il n&#39;y a pas de SDA suivante, on met NULL à la place : les patients de cette salle_even iront soit à la queue de sortie, soit en salle d&#39;examens complémentaires.</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">        Le nombre de patients correspond au nombre de patients du circuit long.</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">        Les durées des tâches sont principalement de l&#39;ordre de 1h +-35 minutes, mais cela peut être légèrement plus ou moins grâce à la composante aléatoire.</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">        Le groupement de boxs est généré par la fonction grouperBoxs de salles.c. Elle prend un nombre d&#39;arguments variables et renvoie un tableau de ptr vers des box (salle_even**) qui est assigné au champ boxs de la salle instanciée.</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">        On indique également le nombre de box pour délimiter l&#39;accès au tableau de box.*/</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        S_EXAMEN_COURT=<a class="code" href="salles_8c.html#a647c9b0bb00267b3c8220f143f1892f4">creerSalleEven</a>(<span class="stringliteral">&quot;salle d&#39;examens (circuit court)&quot;</span>,SDA4,NULL,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nb_patients_cc,45,20,<a class="code" href="salles_8c.html#abdfaefa1a2ae1288d772d48efc21d02c">grouperBoxs</a>(2,BOX4,BOX5),2);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        BOX_CPT1 = <a class="code" href="salles_8c.html#a3c356fda632f22019265eb76e6f11cdf">creerBox</a>(<span class="stringliteral">&quot;box d&#39;examen complementaire 1&quot;</span>) ; BOX_CPT2 = <a class="code" href="salles_8c.html#a3c356fda632f22019265eb76e6f11cdf">creerBox</a>(<span class="stringliteral">&quot;box d&#39;examen complementaire 2&quot;</span>) ;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        S_EXAMEN_CPT=<a class="code" href="salles_8c.html#a647c9b0bb00267b3c8220f143f1892f4">creerSalleEven</a>(<span class="stringliteral">&quot;salle d&#39;examens complementaires&quot;</span>,NULL,NULL,(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nb_patients_cl_cpt,60,30,<a class="code" href="salles_8c.html#abdfaefa1a2ae1288d772d48efc21d02c">grouperBoxs</a>(2,BOX_CPT1,BOX_CPT2),2); <span class="comment">//Pour les durées d&#39;examen complémentaire, on choisit une espérance de 1h20min et un écart de 40 min.</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        tableau_salles_attente[0] = SDA1;tableau_salles_attente[1] = SDA2;tableau_salles_attente[2] = SDA3;tableau_salles_attente[3] = SDA4; <span class="comment">//on créée un tableau de ptr vers des salles d&#39;attente pour des traitements groupés.</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        tableau_salles_even[0] = S_ENREG;tableau_salles_even[1] = S_EXAMEN_IOA;tableau_salles_even[2] = S_EXAMEN_LONG;tableau_salles_even[3]=S_EXAMEN_CPT;tableau_salles_even[4] = S_EXAMEN_COURT;<span class="comment">//on créée un tableau de ptr vers des salles_even pour les parcourir pendant le flux et pour des traitements de groupe</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">//DEBUT DU FLUX</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        <span class="keywordtype">bool</span> modification=<span class="keyword">true</span>; <span class="comment">//permet de relancer le flux avant d&#39;incrémenter le temps de la simulation si une modification a eu lieu</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        <span class="keywordtype">bool</span> changementminute=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment">//changementminute servira à sauter des lignes entre les événements ne se produisant pas au même moment</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordtype">bool</span> changementdate=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="comment">//changement date permettra d&#39;afficher la date lorsque l&#39;on changera de jour et qu&#39;un événement devra se produire</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="comment">//Ouverture du fichier de l&#39;historique en écriture</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        FILE *fhistorique;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="keywordtype">bool</span> acces_fichier = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span>(!(fhistorique = fopen(<span class="stringliteral">&quot;historique.txt&quot;</span>,<span class="stringliteral">&quot;w&quot;</span>))) {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            acces_fichier=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;           }</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="comment">//VARIABLES TEMPORAIRES POUR MANIPULER LES PATIENTS, BOXS ... DE CHAQUE SALLE</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">/*Utiliser des variables intermédiaires pour désigner les patients manipulés, les box d&#39;une salle en possédant, les queues des salles d&#39;attente concernées ... s&#39;avèrera très pratique,</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">         étant donné le nombre d&#39;opérations à réaliser sur ces différents éléments.*/</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> jour_prochainevenement;<span class="comment">//Caractère prédisant le jour auquel doit se produire le prochain événement. Permet d&#39;afficher la date uniquement lorsqu&#39;elle change.</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordtype">char</span> evenement[130];<span class="comment">//message qui stockera le descriptif d&#39;un événement, sans l&#39;heure et le nom de la salle de destination.</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordtype">char</span> msg_sortie[35]=<span class="stringliteral">&quot;quitte le service des urgences&quot;</span>;<span class="comment">//chaîne contenant un message utilisé à plusieurs reprises, affiché lorsque les patients quittent le service des urgences.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <span class="keywordtype">char</span> msg_salle_avec_boxs[60]; <span class="comment">//les salles contenant des box utiliseront un message permettant de mentionner le numéro du box concerné par un événement.</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <a class="code" href="struct_queue.html">Queue</a> *q; <span class="comment">//Désignera la queue d&#39;une salle_dattente d&#39;intérêt.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <a class="code" href="structsalle__even.html">salle_even</a>* psalle; <span class="comment">//Désignera la salle_even contrôlant le flux de patients.</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <a class="code" href="structsalle__even.html">salle_even</a>* pbox; <span class="comment">//Désignera un box de psalle choisi. Les boxs sont les cases du champ boxs (salle_even**) de la salle_even (voir salles.h)</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <a class="code" href="structsalle__even.html">salle_even</a>* pbox2; <span class="comment">//Désignera les boxs de la salle précédant psalle. Utilisée dans le cas de la salle d&#39;examens complémentaires, qui est précédée par une salle avec des boxs et doit donc les gérer individuellement</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="structpatient.html">patient</a>* ppatient; <span class="comment">//Désignera le patient manipulé par psalle.</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="structtemps.html">temps</a> duree;    <span class="comment">//Désignera une durée d&#39;événement, utilisée pour de nombreux traitements et assignations au sein du flux.</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="comment">/*On va définir temps_simulation, la date et l&#39;heure de la simulation.</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">        Ce temps sera &quot;incrémenté&quot; (fonction incrementerTemps(temps* t) de temps.c) à chaque fois qu&#39;il ne restera plus aucun traitement possible sur les salles et tant que tous les patients ne seront pas sortis.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">        On définit aussi temps_simulation_prec qui enregistrera la date et l&#39;heure précédent chaque incrémentation de temps_simulation. On aura besoin de cette variable pour notifier les changements de date.*/</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        temps_simulation = <a class="code" href="queue_8c.html#a17b98cf7a290240aca595fa0462803d6">element_debut_queue</a>(ENTREE)-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>; <span class="comment">//on initialise l&#39;heure de la simulation à l&#39;heure d&#39;arrivée du premier patient.</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <a class="code" href="structtemps.html">temps</a> temps_simulation_prec;temps_simulation_prec.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=0;temps_simulation_prec.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=0;temps_simulation_prec.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>=0;temps_simulation_prec.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>=0;temps_simulation_prec.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>=0;<span class="comment">//initialisée à un temps nul pour pouvoir l&#39;utiliser dans une comparaison la première fois</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        jour_prochainevenement=temps_simulation.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>;<span class="comment">//On sait que le premier événement surviendra le jour d&#39;arrivée du premier patient.</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">while</span>(SORTIE-&gt;<a class="code" href="struct_queue.html#a0bf6ad4952ce081299e7eb3c95eeeef4">taille</a>&lt;nombre_patients) { <span class="comment">//Tant que tous les patients créés ne sont pas sortis, incrémentation du temps simulation et contrôle du flux. Esperons qu&#39;aucun ne meure avant ...</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">if</span>(changementdate==<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                <span class="comment">//Si on a changé de jour</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                printf(<span class="stringliteral">&quot;\n\tLe : &quot;</span>);<a class="code" href="temps_8c.html#ab43e72c2edbbd3e180e79c9a09a562f7">afficher_date</a>(temps_simulation);<span class="comment">//AFFICHAGE DE LA DATE</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                fprintf(fhistorique,<span class="stringliteral">&quot;\n\tLe : %02d/%02d/%04d&quot;</span>,temps_simulation.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>,temps_simulation.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>,temps_simulation.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>);<span class="comment">//ECRITURE DANS LE FICHIER HISTORIQUE EGALEMENT</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                changementdate=<span class="keyword">false</span>;<span class="comment">//on indique qu&#39;on n&#39;a plus à afficher la date jusqu&#39;à ce qu&#39;elle change. On ne pourra pas revenir dans ce if tant que changementdate restera à false.</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                changementminute=<span class="keyword">true</span>;<span class="comment">//Il faut toujours sauter une ligne et afficher l&#39;heure après avoir affiché une nouvelle date.</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            <span class="comment">//On commence par remplir SDA1 lorsque la simulation atteint l&#39;heure d&#39;arrivée du patient en tête de la file</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">do</span> {<span class="comment">//cette boucle se poursuit tant que des modifications ont eu lieu. Plus de détails à l&#39;accolade de fin.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                modification=<span class="keyword">false</span>;<span class="comment">//modification est initialisé à faux à chaque tour de boucle, et devient vrai à la moindre modification.</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="comment">//Première étape du flux : on commence, à chaque fois, par faire entrer en salle d&#39;attente 1 les patients en tête de file de la queue ENTREE lorsque leur instant d&#39;arrivée atteint temps_simulation.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="keywordflow">if</span>(!<a class="code" href="queue_8c.html#a89840d7ec790d4b8fef47ae3e6120fb6">estVide</a>(ENTREE)) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                    <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(<a class="code" href="queue_8c.html#a17b98cf7a290240aca595fa0462803d6">element_debut_queue</a>(ENTREE)-&gt;arrivee,temps_simulation)&lt;=0) {<span class="comment">//Si le temps_simulation atteint l&#39;heure d&#39;arrivee du patient en tête de file</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                        modification=<span class="keyword">true</span>;<span class="comment">//On enregistre une modification. Ainsi, si le deuxième patient dans la file est arrivé à la même heure, il sera lui aussi mis en SDA1, et ainsi de suite.</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        ppatient=<a class="code" href="queue_8c.html#a17b98cf7a290240aca595fa0462803d6">element_debut_queue</a>(ENTREE);<span class="comment">//on prend le patient en tête de file (element_debut_queue(Queue Q*) est définie dans queue.c)</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                        <a class="code" href="salles_8c.html#a23e22b98fc1f218ca1bf80e1c597212e">ajouterPatientSalleDattente</a>(SDA1,ppatient);<span class="comment">//on le met dans la queue de SDA1 ( ajouterPatientSalleDattente(salle_dattente* Salle_Dattente,patient *Patient) est définie dans salles.c)</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                        <span class="comment">//AFFICHAGE DE L&#39;HEURE ET DE L&#39;EVENEMENT, ENREGISTREMENT DANS LE FICHIER HISTORIQUE (fonction notifier_evenement)</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        sprintf(evenement,<span class="stringliteral">&quot;Le patient %3d (%s %s) arrive aux urgences et entre en &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);<span class="comment">//enregistrement du descriptif de l&#39;événement dans la chaîne evenement.</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        changementminute = <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(changementminute,temps_simulation,evenement,SDA1-&gt;<a class="code" href="structsalle__dattente.html#af8e31f49164ea2aab080871435024c69">message</a>,fhistorique);<span class="comment">/*</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">                        La fonction notifier_evenement est définie dans main.c. Elle affiche un événement (heure + descriptif + salle) dans la console</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">                        et en enregistre une version légèrement différente dans le fichier historique.</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">                        Une ligne est sautée et l&#39;heure est affichée si changementminute est vrai. La fonction retourne toujours faux, que l&#39;on assigne à changementminute pour notifier qu&#39;on a déjà &quot;consommé&quot; le changement de minute.</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">                        (on a fait le choix d&#39;écrire l&#39;heure seulement quand elle change et de garder groupés les événements survenus à la même heure.*/</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                        ppatient=NULL;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        <a class="code" href="queue_8c.html#a50c657862cadc709779c65dddfb4b661">dequeue</a>(ENTREE);<span class="comment">//il faut ensuite enlever le patient (la tête de file) de la queue d&#39;entree pour que le suivant devienne la nouvelle tête de file, prêt à entrer en SDA1. dequeue(Queue Q*) est définie dans queue.c.</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    <span class="keywordflow">if</span>(!<a class="code" href="queue_8c.html#a89840d7ec790d4b8fef47ae3e6120fb6">estVide</a>(ENTREE)) { <span class="comment">/*si la queue d&#39;entrée n&#39;est toujours pas vie même après l&#39;utilisation de de dequeue, on prédit qu&#39;un événement va arriver le jour d&#39;arrivée de la nouvelle tête de file.</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">                        On conserve ce jour dans jour_prochainevenement s&#39;il est plus proche que le prochain événement alors prédit, ou si on a fait aucune prédiction (jour_prochainevenement==0).*/</span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                                <span class="keywordflow">if</span>(jour_prochainevenement&gt;<a class="code" href="queue_8c.html#a17b98cf7a290240aca595fa0462803d6">element_debut_queue</a>(ENTREE)-&gt;arrivee.jour||jour_prochainevenement==0) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                                    <span class="comment">//on donne à jour_prochainevenement la valeur du jour de l&#39;événement qui arrivera en premier</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                                    jour_prochainevenement=<a class="code" href="queue_8c.html#a17b98cf7a290240aca595fa0462803d6">element_debut_queue</a>(ENTREE)-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                            }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">char</span> k=4;k&gt;=0;k--) {<span class="comment">//On va parcourir tableau_salles_even, un tableau de (salle_even *) qui les contient toutes, en commençant par la fin (pour vider les salles occupées avant de regarder si elles sont libres)</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    <span class="comment">//Nous avons fait le choix de définir une gestion du flux générale, plutôt que de gérer chaque salle individuellement. IL faut cependant distinguer les différents cas qui se présentent.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                    psalle=tableau_salles_even[k]; <span class="comment">//pour chaque salle du tableau de salle_even</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    <span class="keywordflow">if</span> (psalle-&gt;<a class="code" href="structsalle__even.html#acd7d926085aa391de3d07c029210b672">nombre_boxs</a>==0) { <span class="comment">//si la salle N&#39;A PAS DE BOX (S_ENREG, S_EXAM_IOA)</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; </div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                        <span class="keywordflow">if</span>(psalle-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>==<span class="keyword">false</span>) { <span class="comment">//si la salle est OCCUPEE, elle doit peut-être être libérée. Le champ booléen libre de (salle_even) indique que la salle ou ses boxs contiennent des patients.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                            <span class="comment">/*La libération d&#39;une telle salle se déroule comme suit :</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">                            Si la salle est occupée, et si la salle a atteint son heure de libération, le patient est ajouté à la queue de la sda suivante et est supprimé de la salle actuelle.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">                            On affiche entre temps un message correspondant à la tâche et on en enregistre une copie dans le fichier historique.</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">                            Enfin, on indique que la salle est libre*/</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                            <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(psalle-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>,temps_simulation)&lt;=0) { <span class="comment">/*si la simulation a atteint l&#39;heure de libération de la salle, il faut la libérer. comparerTemps(temps t1,temps t2) est définie dans temps.c.</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">                                Cette fonction renvoie -1 si t1 &lt; t2, 0 si t1 = t2, et 1 si t1 &gt; t2.*/</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                                modification=<span class="keyword">true</span>; <span class="comment">//On enregistre une modification</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                                ppatient = psalle-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a>; <span class="comment">//On prend son patient</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                <span class="comment">/*Les salle_even ont deux champs : salle_prec et salle_suiv, pointeurs vers une salle d&#39;attente précédente et une salle d&#39;attente suivante.</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment">                                C&#39;est elles qui se chargent de prendre un patient dans la sda précédente et de l&#39;envoyer dans la sda suivante quand la tâche est terminée.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment">                                Les liens vers les sda préc et suiv sont attribués à la création des salles, avant la simulation.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">                                Dans le cas de la salle d&#39;examen IOA, il peut y avoir deux salle_suiv différentes selon le circuit attribué au patient.</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">                                Il faut donc gérer ce cas particulier et modifier salle_prec et salle_suiv en conséquence.*/</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                <span class="keywordflow">if</span>(psalle==S_EXAMEN_IOA) {<span class="comment">//Gestion du cas particulier</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                                        <span class="comment">//Si la salle_even est IOA, sa salle_suiv est soit SDA4, soit SDA3, selon le circuit attribué au patient.</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                                    <span class="keywordflow">if</span>(ppatient-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>==<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ae245e90149daf6036ece3cb84960aab1">COURT</a>)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                        psalle-&gt;<a class="code" href="structsalle__even.html#ad5707ffc634e32bc3d1da351a407fc0e">salle_suiv</a>=SDA4;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                        psalle-&gt;<a class="code" href="structsalle__even.html#ad5707ffc634e32bc3d1da351a407fc0e">salle_suiv</a>=SDA3; <span class="comment">//TODO : POINTEURS DE STRUCTURES</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                                }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                <a class="code" href="salles_8c.html#a23e22b98fc1f218ca1bf80e1c597212e">ajouterPatientSalleDattente</a>(psalle-&gt;<a class="code" href="structsalle__even.html#ad5707ffc634e32bc3d1da351a407fc0e">salle_suiv</a>,ppatient); <span class="comment">//ajouterPatientSalleDattente est définie dans salles.c. Elle ajoute un patient au bout de la queue d&#39;une sda.</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                                <span class="comment">//AFFICHAGE DE L&#39;HEURE ET DE l&#39;EVENEMENT, ENREGISTREMENT DANS LE FICHIER HISTORIQUE</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                sprintf(evenement,<span class="stringliteral">&quot;Le patient %3d (%s %s) entre dans la &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                changementminute = <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(changementminute,temps_simulation,evenement,psalle-&gt;<a class="code" href="structsalle__even.html#ad5707ffc634e32bc3d1da351a407fc0e">salle_suiv</a>-&gt;<a class="code" href="structsalle__dattente.html#af8e31f49164ea2aab080871435024c69">message</a>,fhistorique);<span class="comment">//saut de ligne et affichage de l&#39;heure si on a changé d&#39;heure. Actualisation du booléen changementminute</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160; </div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                                psalle-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a> = <span class="keyword">true</span>; <span class="comment">//on indique que la salle est maintenant libre.</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                psalle-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a>=NULL; <span class="comment">//Le pointeur vers le patient contenu par la salle passe à NULL.</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                                ppatient=NULL;  <span class="comment">//La variable intermédiaire oublie également l&#39;adresse du patient pour éviter les erreurs.</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                            }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                        }</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                        <span class="keywordflow">if</span>(psalle-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>==<span class="keyword">true</span>) { <span class="comment">//Maintenant, si la salle est LIBRE (/vient d&#39;être libérée : nous ne sommes pas dans un else, on regarde si la salle est libre juste après l&#39;avoir potentiellement libérée.)</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                            <span class="comment">/*Le remplissage d&#39;une salle_even de ce type (ne possédant pas de box) s&#39;effectue de la manière suivante :</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">                            On prend l&#39;adresse du patient en tête de la queue de la  salle d&#39;attente précédente, on la stocke dans le champ patient de la salle_even actuelle, et on le supprime de la queue de la salle précédente.</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">                            On affiche et on grave dans le fichier historique le message correspondant.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment">                            On demande/génère (selon les options choisies) la durée de la tâche et on calcule la valeur à stocker dans le champ heure_liberation de la salle comme : duree + temps_simulation.</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">                            Enfin, on indique que la salle est maintenant occupée.*/</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                            q = psalle-&gt;<a class="code" href="structsalle__even.html#a0a7b992c2b0f2981f7fd9f7e15e9bed1">salle_prec</a>-&gt;<a class="code" href="structsalle__dattente.html#a1a1377b2b0551a3465c085e88f0329b0">QUEUE</a>;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                            <span class="keywordflow">if</span>(!<a class="code" href="queue_8c.html#a89840d7ec790d4b8fef47ae3e6120fb6">estVide</a>(q)) { <span class="comment">//si la queue de la salle précédente (forcément une salle d&#39;attente) n&#39;est pas vide</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                                ppatient=<a class="code" href="queue_8c.html#a17b98cf7a290240aca595fa0462803d6">element_debut_queue</a>(q); <span class="comment">//on prend le patient au début de la queue de la salle d&#39;attente précédente</span></div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                psalle-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a> = ppatient;<span class="comment">//et on le fait entrer dans la salle actuelle</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                modification=<span class="keyword">true</span>;<span class="comment">//On notifie une modification</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                <span class="comment">//AFFICHAGE DU MESSAGE</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                                <span class="comment">//AFFICHAGE DE L&#39;HEURE ET DE l&#39;EVENEMENT, ENREGISTREMENT DANS LE FICHIER HISTORIQUE</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                sprintf(evenement,<span class="stringliteral">&quot;Le patient %3d (%s %s) entre en &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                changementminute = <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(changementminute,temps_simulation,evenement,psalle-&gt;<a class="code" href="structsalle__even.html#ac874262dd5ae0818c46ac185ee7a5b55">message</a>,fhistorique);<span class="comment">//saut de ligne si on a changé d&#39;heure</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160; </div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                                psalle-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>=<span class="keyword">false</span>;<span class="comment">//on notifie que la salle est occupée</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                psalle-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>=temps_simulation;<span class="comment">//On commence par affecter à psalle-&gt;heure_liberation la valeure de temps_simulation</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                <span class="keywordflow">if</span>(!generation_durees_auto) {<span class="comment">//Si on est en mode durees manuelles :</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                    duree = <a class="code" href="temps_8c.html#a805f024985dcaa7a6bec43095d8990a9">demander_duree</a>(); <span class="comment">//saisie manuelle de la durée au format &quot;hh:mm&quot; ou &quot;hh&quot; par l&#39;utilisateur</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                                <span class="keywordflow">else</span>{<span class="comment">//Sinon, on est en mode durées générées automatiquement :</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                    duree=<a class="code" href="aleatoire_8c.html#aeed8498cbad80a2d4b08e1c78acfd73e">genererDureeTache</a>(psalle-&gt;<a class="code" href="structsalle__even.html#ac2341779f151d713968994416d34620c">d_esperance</a>,psalle-&gt;<a class="code" href="structsalle__even.html#ae86fcb20ed2991c56dfaa3d11cce1358">d_ecart</a>);<span class="comment">/*La fonction générerDureeTache(unsigned int esperance, unsigned int ecart) est définie dans aleatoire.c.</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">                                    Elle génère, à l&#39;aide de la loi normale et d&#39;une légère composante aléatoire, une durée opératoire le plus souvent comprise entre espérance-écart et espérance+écart.</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">                                    La probabilité d&#39;obtenir des valeurs proches de l&#39;espérance est beaucoup plus forte, on a donc une durée proche de la &quot;normale&quot; et des durées &quot;inhabituelles&quot; plus rarement attribuées.</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">                                    Pour les petites durées (&lt;10 minutes), la composante aléatoire a plus de poids (choix arbitraire pour avoir des durées moins semblables pour les opérations telles que l&#39;enregistrement et l&#39;examen ioa).</span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">                                    L&#39;espérance et l&#39;écart des durées est attribuée arbitrairement à chaque salle, à leur création, avant le début de la simulation.*/</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                                }</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                                    <span class="comment">/*Gestion des éléments destinés à servir pour l&#39;établissement des statistiques : les (salle_even) ont</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment">                                    - un champ ordre (usi*) qui retient l&#39;id des patients dans leur ordre d&#39;arrivée</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">                                    - un champ tab_id_patients (usi*) qui retient l&#39;id des patients passés par la salle et qui sera trié par ordre de durée opératoire croissante</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">                                    - un champ tab_durees (temps*) qui retient les durees de séjour des patients passés par la salle et qui sera trié pour correspondre à tab_id_patients (à même indice, l&#39;id et la durée correspondront à un même patient)</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">                                    - un champ indice qui permet de contrôler l&#39;insertion dans les tableaux (de taille max le nombre de patients qui va passer par la salle).</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">                                    Ces champs servent au calcul des statistiques à l&#39;issue de la simulation et subiront des traitements (tri, opérations ...) en fin de flux*/</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                                    psalle-&gt;<a class="code" href="structsalle__even.html#addccbf4f2a88115bcf8d45e23deaf1c9">ordre</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                    psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=duree;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                                    psalle-&gt;<a class="code" href="structsalle__even.html#aeccb6ff8063926edf565556426c3975b">tab_id_patients</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int)ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>;;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                                    psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>++; <span class="comment">//On incrémente le champ indice pour la prochaine insertion dans les tableaux de la salle. A l&#39;issue de la simulation, indice contient le nombre d&#39;éléments des tableaux.</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                                <a class="code" href="temps_8c.html#a7b65ae2942c2ceddaf59b92851278db5">ajouterTemps</a>(&amp;(psalle-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>),duree); <span class="comment">//mise à jour de l&#39;heure de libération de la salle : psalle-&gt;heure_liberation vaut maintenant temps_simulation + duree. ajouterTemps est définie dans temps.c.</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                                    <span class="keywordflow">if</span>(jour_prochainevenement &gt; psalle-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>||jour_prochainevenement==0) {<span class="comment">//on enregistre le jour de libération comme jour du prochain événement si on a pas une prédiction plus proche ou si on a aucune prédiction.</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                                            jour_prochainevenement=psalle-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                        }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                <a class="code" href="queue_8c.html#a50c657862cadc709779c65dddfb4b661">dequeue</a>(q);<span class="comment">//on enlève le patient de la salle d&#39;attente précédente</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                            }</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                            q = NULL; <span class="comment">//les variables intermédiaires pour la queue de la sda préc. et le patient manipulé oublient leurs valeurs.</span></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                            ppatient=NULL;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                        }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                }</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">else</span>{    <span class="comment">//si la salle A DES BOXS (exam courts, exam longs, exam cpt) : les traitements doivent manipuler les patients à l&#39;intérieur des box.</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                <span class="comment">/*Comme on peut le voir dans salles.h, les box sont contenus dans le champ boxs d&#39;une (salle_even). Il s&#39;agit d&#39;un tableau de (salle_even*). Beaucoup de leurs champs sont inutilisés, mais leur fonctionnement est le même.</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">                Il faudra parcourir chaque box de la salle et les remplir, libérer ou ignorer selon la situation.</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">                De plus, dans le cas de la salle_exam_cpt, la salle précédente n&#39;est pas une salle d&#39;attente avec une queue de patients mais une salle_even avec des boxs : il faudra traiter ce cas séparément pour prendre les patients dans les boxs de S_EXAMEN_LONG*/</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    <span class="keywordflow">if</span>(psalle==S_EXAMEN_CPT) { <span class="comment">//Si la salle est la salle d&#39;examens complémentaires (la seule précédée par une salle_even), le traitement est différent. Il n&#39;y a pas de sda précédente avec une queue de patients mais une salle_even avec des box.</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l &lt; psalle-&gt;<a class="code" href="structsalle__even.html#acd7d926085aa391de3d07c029210b672">nombre_boxs</a>;l++) {<span class="comment">//le champ nombre_boxs permet de délimiter l&#39;indice d&#39;accès au tableau de box (on sait qu&#39;il y en a 2 dans ce cas, mais on préfère garder du dynamisme si on devait ajouter une nouvelle salle du même type par exemple).</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                            pbox=psalle-&gt;<a class="code" href="structsalle__even.html#a4c170acdd626a81fc9de8735494dd23b">boxs</a>[l]; <span class="comment">//Pour chaque box de la salle d&#39;examen complémentaire ...</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                            <span class="keywordflow">if</span>(pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>==<span class="keyword">false</span>) { <span class="comment">//si le box est occupé...</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                                <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>,temps_simulation)&lt;=0) { <span class="comment">//si la simulation a atteint l&#39;heure de sa libération ...</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                    modification=<span class="keyword">true</span>;<span class="comment">//on enregistre une modification pour reboucler avant d&#39;incrémenter le temps de la simulation</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                                    ppatient=pbox-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a>;<span class="comment">//on prend le patient du box choisi</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                                    <a class="code" href="queue_8c.html#acf1baaebc367b53b7a88e9317d77e321">enqueue</a>(SORTIE,ppatient); <span class="comment">//on envoie le patient au bout de la queue de sortie</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                    ppatient-&gt;<a class="code" href="structpatient.html#add67403d62e2740150bfea38fdf266b9">sortie</a>=temps_simulation;<span class="comment">//on enregistre l&#39;heure de sortie du patient dans le champ (temps) sortie du patient</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                    <span class="keywordflow">if</span>(temps_simulation_prec.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>!=temps_simulation.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>&amp;&amp;!changementminute){</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                                        changementminute=<span class="keyword">true</span>; temps_simulation_prec.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>=temps_simulation.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                                    }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                    <span class="comment">//AFFICHAGE DU MESSAGE (HEURE ET DE l&#39;EVENEMENT), ENREGISTREMENT DANS LE FICHIER HISTORIQUE</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                                    sprintf(evenement,<span class="stringliteral">&quot;Le patient %3d (%s %s) &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                                    changementminute = <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(changementminute,temps_simulation,evenement,msg_sortie,fhistorique);<span class="comment">//le message utilisé à la place du nom de la salle est msg_sortie - fixé avant le début du flux.</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                                    jour_prochainevenement=0; <span class="comment">//on efface la prédiciton du prochain événement, parce que la simulation est potentiellement terminée et on ne veut pas réafficher la date après le dernier événement.</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                                    pbox-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a>=NULL; <span class="comment">//on vide le box (il ne contient plus de patient)</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                    ppatient=NULL;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                                    pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>=<span class="keyword">true</span>; <span class="comment">//on notifie que le box est désormais libre</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                                }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                            }</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                            <span class="keywordflow">if</span>(pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>==<span class="keyword">true</span>) {<span class="comment">//si le box est libre/vient d&#39;être libéré</span></div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> b=0;b &lt; S_EXAMEN_LONG-&gt;<a class="code" href="structsalle__even.html#acd7d926085aa391de3d07c029210b672">nombre_boxs</a>;b++) {<span class="comment">//La salle précédente est une salle_even dont les patients sont contenus dans des boxs. Il faut donc parcourir les box de la S_EXAMEN_LONG pour prendre leurs patients</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                    pbox2 = S_EXAMEN_LONG-&gt;<a class="code" href="structsalle__even.html#a4c170acdd626a81fc9de8735494dd23b">boxs</a>[b]; <span class="comment">//pbox2 prend la valeur du box choisi dans la salle précédente. (pbox est toujours le box choisi dans la salle d&#39;examens complémentaires)</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                    ppatient = pbox2-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                                    <span class="keywordflow">if</span>(ppatient&amp;&amp;pbox2-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>==<span class="keyword">false</span>&amp;&amp;pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>==<span class="keyword">true</span>) { <span class="comment">//si le box choisi dans la salle précédente est occupée et que le box choisi dans la salle actuelle est libre ...</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                        <span class="keywordflow">if</span>(ppatient-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>==<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a>) { <span class="comment">//si ce patient est admis en examens complémentaires (sinon, il ne faut pas s&#39;en occuper, il sera libéré par sa propre salle)</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                            <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(pbox2-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>,temps_simulation)&lt;=0) { <span class="comment">//si la simulation a atteint l&#39;heure de libération du box de la salle précédente</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                                modification=<span class="keyword">true</span>;<span class="comment">//on notifie une modification</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                                <span class="comment">//AFFICHAGE DE L&#39;HEURE ET DE l&#39;EVENEMENT, ENREGISTREMENT DANS LE FICHIER HISTORIQUE</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                                                sprintf(evenement,<span class="stringliteral">&quot;Le patient %3d (%s %s) est pris en charge au &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                                                changementminute = <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(changementminute,temps_simulation,evenement,pbox-&gt;<a class="code" href="structsalle__even.html#ac874262dd5ae0818c46ac185ee7a5b55">message</a>,fhistorique);<span class="comment">//le message affiché indique le box accueillant un patient</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                                <span class="keywordflow">if</span>(generation_durees_auto) {</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                                    ppatient-&gt;<a class="code" href="structpatient.html#a595b073371fbe81581c391db3899dc15">duree_examen_complementaire</a>=<a class="code" href="aleatoire_8c.html#aeed8498cbad80a2d4b08e1c78acfd73e">genererDureeTache</a>(psalle-&gt;<a class="code" href="structsalle__even.html#ac2341779f151d713968994416d34620c">d_esperance</a>,psalle-&gt;<a class="code" href="structsalle__even.html#ae86fcb20ed2991c56dfaa3d11cce1358">d_ecart</a>);<span class="comment">//génération auto de la durée de la tâche</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                                }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                                <span class="comment">//enregistrement des éléments qui serviront à la production des statistiques</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                                psalle-&gt;<a class="code" href="structsalle__even.html#addccbf4f2a88115bcf8d45e23deaf1c9">ordre</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                                psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=ppatient-&gt;<a class="code" href="structpatient.html#a595b073371fbe81581c391db3899dc15">duree_examen_complementaire</a>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                                psalle-&gt;<a class="code" href="structsalle__even.html#aeccb6ff8063926edf565556426c3975b">tab_id_patients</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int)ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                                psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>++;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                                pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>=temps_simulation;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                                <a class="code" href="temps_8c.html#a7b65ae2942c2ceddaf59b92851278db5">ajouterTemps</a>(&amp;(pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>),ppatient-&gt;<a class="code" href="structpatient.html#a595b073371fbe81581c391db3899dc15">duree_examen_complementaire</a>); <span class="comment">//enregistrement de l&#39;heure de libération de la salle</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                                    <span class="keywordflow">if</span>(jour_prochainevenement &gt; pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>||jour_prochainevenement==0) {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                                                        jour_prochainevenement=pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>; <span class="comment">//si on a aucune prédiction pour le prochain événement, ou une prédiction pour un jour plus éloigné proche, prédiction d&#39;un événement à l&#39;heure de libération du box.</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                                                    }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                                                pbox-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a>=ppatient;<span class="comment">//On met l&#39;adresse du patient dans le box de la salle actuelle</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                                pbox2-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a>=NULL;<span class="comment">//On la supprime du box de la salle précédente</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>=<span class="keyword">false</span>;<span class="comment">//le box de la salle actuelle devient occupé</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                pbox2-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>=<span class="keyword">true</span>;<span class="comment">//le box de la salle précédente devient libre</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                                                ppatient=NULL;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                                            }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                                        }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                                    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                                }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                                pbox2=NULL;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                            }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                        }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                        pbox=NULL;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                    }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                    <span class="keywordflow">else</span> { <span class="comment">/*si la salle n&#39;est pas la salle d&#39;examens complémentaires : donc la salle d&#39;examens principale du circuit long ou court</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment">                    Les salles de cette classe sont précédées par une salle d&#39;attente où elles puisent leurs patients, possèdent des box, et n&#39;ont pas de sda suivante.*/</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l=0;l &lt; psalle-&gt;<a class="code" href="structsalle__even.html#acd7d926085aa391de3d07c029210b672">nombre_boxs</a>;l++) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                            pbox=psalle-&gt;<a class="code" href="structsalle__even.html#a4c170acdd626a81fc9de8735494dd23b">boxs</a>[l]; <span class="comment">//pour chaque box de la salle choisie...</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                            <span class="keywordflow">if</span>(pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>==<span class="keyword">false</span> &amp;&amp; <a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>,temps_simulation)&lt;=0) { <span class="comment">//si le box est occupe et qu&#39;on a atteint l&#39;heure de liberation ...</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                                ppatient = pbox-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a>; <span class="comment">//on prend le patient du box choisi de notre salle</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                <span class="keywordflow">if</span>(ppatient-&gt;<a class="code" href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">circuit</a>!=<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a>) { <span class="comment">//s&#39;il n&#39;est pas admis en salle d&#39;examens complémentaires, on l&#39;enverra à la sortie</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                                    modification=<span class="keyword">true</span>; <span class="comment">//enregistrement d&#39;une modification</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                    <a class="code" href="queue_8c.html#acf1baaebc367b53b7a88e9317d77e321">enqueue</a>(SORTIE,ppatient); <span class="comment">//le patient quitte le flux de la simulation. Il est ajouté au bout de la queue de sortie.</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                                    ppatient-&gt;<a class="code" href="structpatient.html#add67403d62e2740150bfea38fdf266b9">sortie</a>=temps_simulation;<span class="comment">//on enregistre l&#39;heure de sortie du patient dans son champ (temps) sortie.</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                    <span class="comment">//AFFICHAGE DE L&#39;HEURE ET DE l&#39;EVENEMENT, ENREGISTREMENT DANS LE FICHIER HISTORIQUE</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                                    sprintf(evenement,<span class="stringliteral">&quot;Le patient %3d (%s %s) &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                                    changementminute = <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(changementminute,temps_simulation,evenement,msg_sortie,fhistorique);<span class="comment">//message notifiant la sortie du patient.</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                                    jour_prochainevenement=0; <span class="comment">//effacement des prédictions : la simulation est peut-être terminée et on ne veut pas reafficher la date s&#39;il n&#39;y a plus aucun événement.</span></div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                    pbox-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a> = NULL; <span class="comment">//on supprime l&#39;adresse du patient du box libéré.</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                                    pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a> = <span class="keyword">true</span>; <span class="comment">//on indique que le box n&#39;est plus occupé.</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                                    ppatient = NULL;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                            }</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                            <span class="keywordflow">if</span>(pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>) {<span class="comment">//Si le box est libre, on le remplit avec les patients présents dans la salle d&#39;attente précédente.</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                q = psalle-&gt;<a class="code" href="structsalle__even.html#a0a7b992c2b0f2981f7fd9f7e15e9bed1">salle_prec</a>-&gt;<a class="code" href="structsalle__dattente.html#a1a1377b2b0551a3465c085e88f0329b0">QUEUE</a>; <span class="comment">//on prend la queue de la salle_dattente précédente (ici, SDA3 ou SDA4).</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                <span class="keywordflow">if</span>(!<a class="code" href="queue_8c.html#a89840d7ec790d4b8fef47ae3e6120fb6">estVide</a>(q)) { <span class="comment">//si la queue de la salle précédente n&#39;est pas vide</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                                    modification=<span class="keyword">true</span>;<span class="comment">//On enregistre une modification</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                                    ppatient = <a class="code" href="queue_8c.html#a17b98cf7a290240aca595fa0462803d6">element_debut_queue</a>(q);<span class="comment">//On prend le patient en tête de file</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                    pbox-&gt;<a class="code" href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">Patient</a> = ppatient;<span class="comment">//on ajoute le patient au box de notre salle</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                    <span class="comment">//AFFICHAGE DE L&#39;HEURE ET DE l&#39;EVENEMENT, ENREGISTREMENT DANS LE FICHIER HISTORIQUE</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                    sprintf(msg_salle_avec_boxs,<span class="stringliteral">&quot;%s, %s&quot;</span>,psalle-&gt;<a class="code" href="structsalle__even.html#ac874262dd5ae0818c46ac185ee7a5b55">message</a>,pbox-&gt;<a class="code" href="structsalle__even.html#ac874262dd5ae0818c46ac185ee7a5b55">message</a>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                                    sprintf(evenement,<span class="stringliteral">&quot;Le patient %3d (%s %s) entre en &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                    changementminute = <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(changementminute,temps_simulation,evenement,msg_salle_avec_boxs,fhistorique);<span class="comment">//affichage du message correspondant à l&#39;événement et à notre box, saut de ligne et affichage de l&#39;heure si ce n&#39;est pas déjà fait</span></div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                    <span class="comment">//CALCUL ET ATTRIBUTION DE L&#39;HEURE DE LIBERATION DU BOX</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                    pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>=temps_simulation;</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                                    <span class="keywordflow">if</span>(!generation_durees_auto) {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                                        duree = <a class="code" href="temps_8c.html#a805f024985dcaa7a6bec43095d8990a9">demander_duree</a>(); <span class="comment">//on demande la duree a l&#39;utilisateur</span></div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                    }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                                    <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                        duree=<a class="code" href="aleatoire_8c.html#aeed8498cbad80a2d4b08e1c78acfd73e">genererDureeTache</a>(psalle-&gt;<a class="code" href="structsalle__even.html#ac2341779f151d713968994416d34620c">d_esperance</a>,psalle-&gt;<a class="code" href="structsalle__even.html#ae86fcb20ed2991c56dfaa3d11cce1358">d_ecart</a>);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                                    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                    <a class="code" href="temps_8c.html#a7b65ae2942c2ceddaf59b92851278db5">ajouterTemps</a>(&amp;(pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>),duree);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                                    <span class="comment">//ENREGISTREMENT DES ELEMENTS NECESSAIRES A L&#39;ETABLISSEMENT ULTERIEUR DES STATISTIQUES</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                                    psalle-&gt;<a class="code" href="structsalle__even.html#addccbf4f2a88115bcf8d45e23deaf1c9">ordre</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                    psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=duree;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                                    psalle-&gt;<a class="code" href="structsalle__even.html#aeccb6ff8063926edf565556426c3975b">tab_id_patients</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>]=(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> int)ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                                    psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>++;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                                    pbox-&gt;<a class="code" href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">libre</a>=<span class="keyword">false</span>;<span class="comment">//Le box passe au statut &quot;occupé&quot;</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                                    <a class="code" href="queue_8c.html#a50c657862cadc709779c65dddfb4b661">dequeue</a>(q);<span class="comment">//on supprime l&#39;adresse du patient pris de la tête de file de la salle d&#39;attente précédente.</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                        <span class="keywordflow">if</span>(jour_prochainevenement &gt; pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>||jour_prochainevenement==0) {</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                            jour_prochainevenement=pbox-&gt;<a class="code" href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">heure_liberation</a>.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>;<span class="comment">//on enregistre éventuellement la prédiction d&#39;un événement le jour de libération du box - on affichera alors éventuellement la date en début de boucle le jour venu.</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                                        }</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                }</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                                q = NULL;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                            }</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                         }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                         pbox=NULL;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                    }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                }</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            }<span class="keywordflow">while</span>(modification); <span class="comment">/*S&#39;il y a eu une modification dans le flux, on relance le flux à la même heure. Des places ont pu se libérer !</span></div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="comment">            Exemple : on essaie d&#39;abord de faire entrer des patients de SDA2 dans salle_examen_IOA alors qu&#39;elle est occupée. Ensuite, on libère salle_examen_IOA.</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="comment">            Il faut alors retourner en arrière pour retenter de faire entrer un patient en salle d&#39;examen IOA.</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="comment">            C&#39;est pourquoi, à chaque fois qu&#39;un traitement est effectué sur les salles, on enregistre une modification, et on reboucle à chaque fois qu&#39;une modification est notifiée.</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="comment">            modification est remise à &quot;faux&quot; au début de cette boucle.</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="comment">            Il s&#39;agit d&#39;une boucle do{...}while(...);, donc elle s&#39;éxécutera toujours une première fois et continuera uniquement si des modifications ont été enregistrées*/</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            temps_simulation_prec=temps_simulation;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <a class="code" href="temps_8c.html#a11b9c21874a289b500069369701e1bf1">incrementerTemps</a>(&amp;temps_simulation); <span class="comment">//On fait passer une minute dans la simulation.</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            changementminute=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="comment">//si on a changé de jour et qu&#39;un événement va se produire ce jour-ci, affichage de la date.</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordflow">if</span>(jour_prochainevenement==temps_simulation.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a> &amp;&amp; jour_prochainevenement!=0 &amp;&amp; temps_simulation_prec.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>!=temps_simulation.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                <span class="comment">/*Afin d&#39;afficher la date seulement quand elle change, on prédit le jour où se produira le prochain événement et on l&#39;enregistre dans jour_prochainevenement</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">                (en calculant les heures de libération des salles et en choisissant la plus proche de l&#39;instant simulé)</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">                et on attend que le temps de la simulation atteigne ou dépasse ce jour.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">                Cas particulier : si jour_prochainevenement vaut 0 (assignation faite dans le but d&#39;éviter un réaffichage de la date dans certains cas), le traitement n&#39;est pas réalisé.*/</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                changementdate=<span class="keyword">true</span>;<span class="comment">//l&#39;activation de ce booléen va provoquer l&#39;affichage de la date en début de boucle, après quoi il repassera à &quot;faux&quot;.</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                jour_prochainevenement=0; <span class="comment">//en passant jour_prochainevenement à 0, on s&#39;assure qu&#39;aucun saut de ligne sera provoqué à la prochaine itération. de la boucle</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;4 ; i++) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="keywordflow">if</span>(!<a class="code" href="queue_8c.html#a89840d7ec790d4b8fef47ae3e6120fb6">estVide</a>(tableau_salles_attente[i]-&gt;QUEUE)) {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                    <a class="code" href="salles_8c.html#a3d6ea999ddfc95a1819d3934e3733b2c">patientsAttendent</a>(tableau_salles_attente[i]); <span class="comment">//On fait passer une minute dans le temps d&#39;attente des patients.</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                    <span class="comment">/*A chaque fois que le temps de la simulation est incrémenté d&#39;une minute, on ajoute une minute par patient présent dans chaque salle d&#39;attente au champ &quot;temps_attente&quot; de cette dernière.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment">                    La fonction patientAttendent se charge de ce traitement ; elle est définie dans salle.c*/</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                }</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            }</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        }<span class="comment">//fin de la boucle faisant avancer le flux de patients (Tant qu&#39;ils n&#39;étaient pas tous sortis. Désormais, ils le sont tous.)</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        printf(<span class="stringliteral">&quot;\n_____________________________________________________________________________________\nFIN DU FLUX DE PATIENTS\n\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        fclose(fhistorique); <span class="comment">//Fermeture du fichier fhistorique, dans lequel on écrivait l&#39;historique de la simulation.</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="comment">//CALCUL DES TEMPS D&#39;ATTENTE MOYENS DANS LES SALLES D&#39;ATTENTE</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;4 ; i++) {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;               <span class="keywordflow">if</span>(tableau_salles_attente[i]-&gt;temps_attente!=0) {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <span class="comment">//le champ temps_attente contient, à ce moment, la somme des durees de séjour de chaque patient passé dans la salle</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;               tableau_salles_attente[i]-&gt;<a class="code" href="structsalle__dattente.html#a40026208a5a928e17470ece9a3fcabde">temps_attente</a>/=tableau_salles_attente[i]-&gt;<a class="code" href="structsalle__dattente.html#a1a1377b2b0551a3465c085e88f0329b0">QUEUE</a>-&gt;<a class="code" href="struct_queue.html#a344318fc1db2efc28d3cce1a33702b75">capacite</a>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;               }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;               <span class="comment">//on divise le temps d&#39;attente total de chaque salle par le nombre de patients qui y ont attendu</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="comment">//TRI DES TABLEAUX DE DUREES DES SALLES_EVEN</span></div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;5; i++) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            <a class="code" href="salles_8c.html#a219baa22d6a85b830a8b6388b9f6f546">trierStats</a>(tableau_salles_even[i]);<span class="comment">//la fonction trierStats est définie dans salles.c</span></div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="comment">//on range les durees par ordre croissant, de même que les id des patients correspondant</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">//AFFICHAGE DU MENU PRINCIPAL DE FIN DE SIMULATION</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        requete=0;<span class="comment">//variable stockant le caractère saisi par l&#39;utilisateur</span></div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordtype">bool</span> confirmation;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        reafficher_menu=<span class="keyword">false</span>;<span class="comment">//booléen permettant de réafficher ou non le menu principal après des commandes. déjà utilisé pour le menu des options</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordtype">bool</span> reafficher_menu_stats = <span class="keyword">false</span>; <span class="comment">//booléen permettant de réafficher ou non le menu des statistiques après des commandes</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            printf(<span class="stringliteral">&quot;\n\nDONNEES DE LA SIMULATION\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            puts(<span class="stringliteral">&quot;Saisissez l&#39;une des commandes suivantes :&quot;</span>);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;s&#39; pour afficher les statistiques de la simulation&quot;</span>);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;h&#39; pour afficher l&#39;historique des evenements&quot;</span>);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;p&#39; pour afficher les horaires de passage d&#39;un patient dans les differents services&quot;</span>);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                puts(<span class="stringliteral">&quot;\t- &#39;q&#39; pour mettre fin a la simulation&quot;</span>);</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                fflush(stdin);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                scanf(<span class="stringliteral">&quot; %c&quot;</span>,&amp;requete);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                requete = <a class="code" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a>(requete);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                <span class="keywordflow">switch</span>(requete) { <span class="comment">//on utilise la structure de contrôle switch (...){case ...} pour gérer le menu. On définit un cas pour chaque caractère correspondant à une commande proposée, et un cas par défaut pour les caractères inattendus</span></div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;q&#39;</span> :</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    confirmation = <a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;Etes-vous sur(e) de vouloir quitter la simulation ?&quot;</span>);<span class="comment">//Permet d&#39;éviter de perdre les données de la simulation si l&#39;utilisateur s&#39;est trompé de touche</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                    <span class="keywordflow">if</span>(confirmation==<span class="keyword">true</span>) {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                        reafficher_menu=<span class="keyword">false</span>;<span class="comment">//si l&#39;utilisateur confirme sa volonté de quitter la simulation, on ne réaffiche pas le menu principal et on annonce la fin de la simulation.</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                         printf(<span class="stringliteral">&quot;\n\nFIN DE LA SIMULATION\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                    }</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                        reafficher_menu=<span class="keyword">true</span>;<span class="comment">//si l&#39;utilisateur ne confirme pas, on réaffiche le menu principal.</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;                    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; </div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span> :</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                    reafficher_menu_stats=<span class="keyword">true</span>;<span class="comment">//On va afficher le menu des statistiques (le traitement se fait en dehors de ce switch).</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;h&#39;</span> :</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    printf(<span class="stringliteral">&quot;\n\nHISTORIQUE\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                    <span class="comment">/*Cette commande permet d&#39;afficher l&#39;historique de la simulation (un affichage en tout point identique à celui qui a été fait &quot;en direct&quot; pendant le flux).</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">                    Pendant le flux, à chaque fois qu&#39;on affichait un message dans la console, on écrivait également un message similaire dans le fichier &quot;historique.txt&quot;.</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">                    Il s&#39;agit maintenant d&#39;ouvrir ce fichier en mode lecture et d&#39;en afficher le contenu en filtrant certains éléments, comme la date présente au début de chaque ligne.*/</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                    <span class="keywordtype">char</span> heure[6];<span class="comment">//cette chaîne stockera l&#39;heure associée à une ligne (écrite entre le dernier &#39;!&#39; et le premier &#39;$&#39; de la ligne)</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                    <span class="keywordtype">char</span> heure_prec[6]=<span class="stringliteral">&quot;ooxoo&quot;</span>;<span class="comment">//cette chaîne stockera la dernière heure affichée, ce qui permettra de l&#39;afficher uniquement quand elle change</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                    <span class="keywordflow">if</span>((fhistorique=fopen(<span class="stringliteral">&quot;historique.txt&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>))) { <span class="comment">//Test d&#39;ouverture du fichier en mode lecture. Il faudra gérer le cas où le fichier ne peut être ouvert.</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                        <span class="keywordtype">char</span> c=fgetc(fhistorique);<span class="comment">//on consomme le premier caractère du fichier, un saut de ligne.</span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                        <span class="keywordflow">while</span>(!feof(fhistorique)){<span class="comment">//tant que le curseur de lecture n&#39;a pas atteint la fin du fichier ...</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                            fscanf(fhistorique,<span class="stringliteral">&quot;%c&quot;</span>,&amp;c);<span class="comment">//lecture caractère par caractère du contenu du fichier.</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                            <span class="comment">//Disjonction de cas selon le caractère lu :</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                            <span class="keywordflow">if</span>(c==<span class="charliteral">&#39;!&#39;</span>) {<span class="comment">/*</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">                                Entre les deux caractères &#39;!&#39; se trouve la date associée à l&#39;évènement.</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">                                Elle est nécessaire pour l&#39;affichage de l&#39;historique d&#39;un patient unique mais on ne l&#39;affiche pas dans l&#39;historique complet : on lira plutôt les dates présentes au début de chaque paragraphe.</span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">                                On va donc consommer tous les caractères situés entre deux caractères &#39;!&#39; de la même ligne, ainsi que ces caractères eux-mêmes.</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment">                                De plus, après le deuxième caractère est indiquée l&#39;heure de la tâche que l&#39;on souhaite afficher uniquement la première fois.</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">                                Elle s&#39;étend jusqu&#39;au premier caractère &#39;$&#39;. Ainsi, tous les caractères situés entre le deuxième &#39;!&#39; et &#39;$&#39; seront copiés dans la chaîne heure, que l&#39;on traitera ensuite.*/</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                                <span class="keywordflow">do</span>{ <span class="comment">//si on rencontre un &#39;!&#39;, on parcourt le fichier jusqu&#39;à trouver le prochain sans rien ecrire. (on ignore la date écrite au début de chaque ligne, elle sert pour l&#39;historique d&#39;un patient unique)</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                                  fscanf(fhistorique,<span class="stringliteral">&quot;%c&quot;</span>,&amp;c);<span class="comment">//on consomme le caractère mais on ne l&#39;utilise pas. Le curseur de lecture avance quand-même.</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                                }<span class="keywordflow">while</span>(c!=<span class="charliteral">&#39;!&#39;</span>);<span class="comment">//On a rencontré le deuxième &#39;!&#39;.</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                                <span class="keywordtype">int</span> i=0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                                c=fgetc(fhistorique);<span class="comment">//On lit le premier caractère après le deuxième &#39;!&#39;</span></div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                <span class="keywordflow">while</span>(c!=<span class="charliteral">&#39;$&#39;</span>){<span class="comment">//On lit un caractère. Tant que ce n&#39;est pas &#39;$&#39;, on le copie dans la chaîne heure.</span></div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                    heure[i] = c;<span class="comment">//ensuite, on lit jusqu&#39;au prochain caractere &#39;$&#39; : c&#39;est l&#39;heure de début de la tâche.</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                    i++;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                    c=fgetc(fhistorique);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                };</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                heure[6]=0;<span class="comment">//On termine heure par le car</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                                <span class="keywordflow">if</span>(strcmp(heure,heure_prec)!=0){ <span class="comment">//si l&#39;heure n&#39;a pas déjà été affichée, on l&#39;affiche.</span></div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;                                    printf(<span class="stringliteral">&quot;%s&quot;</span>,heure);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;                                    strcpy(heure_prec,heure); <span class="comment">//on enregistre l&#39;heure affichée dans l&#39;heure précédente pour ne pas la réafficher.</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;                                }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;                                <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                                    printf(<span class="stringliteral">&quot;     &quot;</span>);<span class="comment">//sinon, on l&#39;ignore et on affiche du vide à la place.</span></div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                                }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;                            }</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (c!=<span class="charliteral">&#39;$&#39;</span>){ <span class="comment">//on ignore les caractères &#39;$&#39;</span></div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                putchar(c); <span class="comment">//Tous les autres caractères sont affichés dans l&#39;ordre où ils se trouvent dans le fichier.</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                            }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                        }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                        fclose(fhistorique);<span class="comment">//Le fichier historique est fermé à la fin de la lecture.</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                    }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                        puts(<span class="stringliteral">&quot;Erreur lors de l&#39;ouverture du fichier contenant l&#39;historique de la simulation.&quot;</span>); <span class="comment">//en cas d&#39;échec d&#39;ouverture de historique.txt, on prévient l&#39;utilisateur.</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                    }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                    saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                    reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                    <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span> :</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    fflush(stdin);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                    <span class="keywordtype">bool</span> encore=<span class="keyword">true</span>; <span class="comment">//on utilisera le booléen &quot;encore&quot; pour reboucler pour un autre patient, afin d&#39;éviter à l&#39;utilisateur d&#39;avoir à saisir une nouvelle fois les commandes.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                        puts(<span class="stringliteral">&quot;\nListe des patients de la simulation : \n&quot;</span>);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;nombre_patients;i++) {</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                            ppatient = <a class="code" href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a>(i+1,liste_patients,nombre_patients);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                            printf(<span class="stringliteral">&quot;Patient %3d (%s %s)\n&quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                        }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                        printf(<span class="stringliteral">&quot;\nVeuillez entrer le numero correspondant au patient choisi dans la liste : &quot;</span>); <span class="comment">//affichage de la liste des patients pour sélection de l&#39;un d&#39;entre eux</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        <span class="keywordtype">int</span> ID;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                        scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;ID); <span class="comment">//saisie de l&#39;id d&#39;un patient de la liste pour afficher son historique</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                        <span class="keywordflow">while</span>(!<a class="code" href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a>(ID,liste_patients,nombre_patients)) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                            printf(<span class="stringliteral">&quot;\nAucun patient correspondant. Assurez-vous de bien saisir un nombre compris entre 1 et %d.\n&quot;</span>,nombre_patients);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                            fflush(stdin);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                            scanf(<span class="stringliteral">&quot;%d&quot;</span>,&amp;ID);<span class="comment">//gestion d&#39;une saisie incorrecte</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                        }</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                        fflush(stdin);</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                        printf(<span class="stringliteral">&quot;\nHORAIRES DE PASSAGE DANS LES DIFFERENTS SERVICES : \n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                        <span class="comment">/*Cette commande permet de sélectionner un patient de la simulation pour afficher son historique.</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">                        L&#39;historique de toute la simulation est enregistré dans un fichier texte créé lors de la simulation.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">                        Pour lire l&#39;historique d&#39;un seul patient, on va lire toutes les lignes de l&#39;historique en repérant uniquement celles qui concernent le patient choisi.</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">                        La date de passage sera également indiquee a chaque ligne du fichier, et affichee si la derniere date affichee etait differente.</span></div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">                        Ainsi, on gère le cas des patients qui entre un jour et sortent le lendemain.*/</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                        <span class="keywordflow">if</span>((fhistorique=fopen(<span class="stringliteral">&quot;historique.txt&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>))) { <span class="comment">//si le fichier historique.txt a pu être ouvert en lecture...</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                            <span class="keywordtype">char</span> c;</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                            <span class="keywordtype">char</span> chaine_patient_choisi[31]; <span class="comment">//Cette chaine contiendra &quot;Le patient ID&quot; avec l&#39;id du patient correspondant. Elle sert à repérer les lignes correspondant au patient choisi</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                            <span class="keywordtype">char</span> *occurence; <span class="comment">//Cette chaine contiendra tour à tour chaque ligne du fichier historique.</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                            <span class="keywordtype">char</span> *curseur; <span class="comment">//ce pointeur vers un caractere sera utilise pour localiser le caractere de debut et de fin des differentes parties d&#39;une ligne du fichier.</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                            <span class="keywordtype">char</span> heure[6]; <span class="comment">//cette chaine stockera les chiffres composant l&#39;heure a laquelle la tache est effectuee. exemple : &quot;10:03\0&quot;</span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                            <span class="keywordtype">char</span> heure_prec[6]=<span class="stringliteral">&quot;ooxoo&quot;</span>;<span class="comment">//permet de stocker l&#39;heure précédente pour mettre un évidence un possible changement d&#39;heure</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                            <span class="keywordtype">char</span> date_prec[11]=<span class="stringliteral">&quot;00/00/0000&quot;</span>; <span class="comment">//permet de stocker la date précédente pour mettre en évidence un possible changement de date</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                            <span class="keywordtype">char</span> date[11];<span class="comment">//cette chaine stocke la date indiquee au debut de la ligne, correspondant a la date à laquelle la tâche commence</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                            ppatient = <a class="code" href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a>(ID,liste_patients,nombre_patients);<span class="comment">//présentation du patient choisi.</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                            printf(<span class="stringliteral">&quot;Parcours du patient %d (%s %s) :\n&quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                            <span class="keywordflow">while</span>(!feof(fhistorique)){<span class="comment">//tant que la fin de l&#39;historique n&#39;est pas atteinte</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                                fgets(evenement,<span class="keyword">sizeof</span>(evenement),fhistorique);<span class="comment">//lire une ligne du fichier et l&#39;enregistrer dans la chaine &quot;evenement&quot;</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                                sprintf(chaine_patient_choisi,<span class="stringliteral">&quot;Le patient %3d (&quot;</span>,ID); <span class="comment">//on crée une chaine : Le patient ID ...</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                                occurence = strstr(evenement,chaine_patient_choisi);<span class="comment">//on sélectionne les lignes contenant : Le patient ID...</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                <span class="keywordflow">if</span>(occurence!=NULL) { <span class="comment">//si la ligne ne contient pas &quot;chaine_patient_choisi&quot; càd s&#39;il n&#39;y a aucune occurence de cette chaîne dans evenement ...</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                                    curseur=strchr(evenement,<span class="charliteral">&#39;!&#39;</span>)+1*<span class="keyword">sizeof</span>(char);<span class="comment">//on va chercher la date (qui commence après le premier caractère !). et regarder si il faut la reafficher. curseur pointe vers le premier caractère de la date dans la ligne.</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                                    <span class="comment">/*on a fait le choix d&#39;utiliser des fonctions de recherche de caractere et non directement des indices correspondant à la position des caractères dans la chaîne au cas où il serait nécessaire de modifier</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">                                    , à l&#39;avenir, le contenu du fichier historique*/</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                                    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                                    <span class="keywordflow">do</span>{</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                                        c=curseur[i];</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                                        <span class="keywordflow">if</span>(c!=<span class="charliteral">&#39;!&#39;</span>) date[i]=c;<span class="comment">//on écrit dans date tous les caractères à partir de curseur, jusqu&#39;à rencontrer &quot;!&quot;, que l&#39;on ignore</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                            i++;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                        }<span class="keywordflow">while</span>(c!=<span class="charliteral">&#39;!&#39;</span>);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                                        date[10]=<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                        <span class="keywordflow">if</span>(strcmp(date_prec,date)!=0) { <span class="comment">//si la date de la tache a change par rapport a la derniere date affichee</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                            printf(<span class="stringliteral">&quot;\n\tLe %s :&quot;</span>,date); <span class="comment">//afficher la nouvelle date</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                            strcpy(date_prec,date); <span class="comment">//mettre a jour date_prec pour se rappeler qu&#39;on a deja affiché la nouvelle date.</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                                        }</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                                        i=0;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                                        curseur = strrchr(evenement,<span class="charliteral">&#39;!&#39;</span>)+1*<span class="keyword">sizeof</span>(char); <span class="comment">//on va chercher le second &#39;!&#39;</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                                        <span class="keywordflow">do</span>{<span class="comment">//on va recuperer et afficher l&#39;heure, de &#39;!&#39; jusqu&#39;à &#39;$&#39; :</span></div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                                            c=curseur[i];</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                                            <span class="keywordflow">if</span>(c!=<span class="charliteral">&#39;$&#39;</span>){heure[i]=c;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                                            i++;}</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                                        }<span class="keywordflow">while</span>(c!=<span class="charliteral">&#39;$&#39;</span>);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                                        heure[i]=<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                                        curseur = strrchr(evenement,<span class="charliteral">&#39;$&#39;</span>)+1*<span class="keyword">sizeof</span>(char);<span class="comment">//on prend tout ce qu&#39;il reste après le second $ (donc la salle)</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                                        curseur[0] = <a class="code" href="main_8c.html#a8c2aa30c45c2b133140df33e611c7b3f">convertir_majuscules</a>(curseur[0]);<span class="comment">//conversion en majuscules de la première lettre de la salle pour faire joli.</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                                        <span class="keywordflow">if</span>(strcmp(heure_prec,heure)!=0) { <span class="comment">//on affiche l&#39;heure uniquement quand elle change</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                                            strcpy(heure_prec,heure);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                                            printf(<span class="stringliteral">&quot;\n%s : %s&quot;</span>,heure,curseur); <span class="comment">//affichage de l&#39;heure et de tout le reste de &quot;événement&quot; à partir du deuxième $, donc la salle.</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                                        }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                                        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                                            printf(<span class="stringliteral">&quot;      : %s&quot;</span>,curseur);<span class="comment">//sinon, on ne reaffiche pas l&#39;heure</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                                        }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                                    }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                                }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                                fclose(fhistorique);<span class="comment">//fermeture du fichier historique</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                            }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                puts(<span class="stringliteral">&quot;Erreur lors de l&#39;ouverture du fichier contenant l&#39;historique de la simulation.&quot;</span>);<span class="comment">//gestion du cas où le fichier historique n&#39;aurait pas été produit ou échouerait à s&#39;ouvrir</span></div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                            }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                            encore=<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\n\nVoulez-vous afficher les horaires de passage d&#39;un autre patient ?&quot;</span>); <span class="comment">//proposition de reboucler pour éviter à l&#39;utilisateur d&#39;avoir à naviguer dans les menus</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                        }<span class="keywordflow">while</span>(encore);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                        saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                        reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                        reafficher_menu_stats=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                    default :</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                    puts(<span class="stringliteral">&quot;Saisie incorrecte. Veuillez reessayer :&quot;</span>);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                    saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;            }<span class="keywordflow">while</span>(!saisie_correcte);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;            <span class="keywordflow">do</span> { <span class="comment">//MENU SECONDAIRE (STATISTIQUES)</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="comment">/*</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">                Menu utilisé pour afficher des statistiques à la demande de l&#39;utilisateur.</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">                Séparé du reste pour ne pas surcharger l&#39;affichage, car il y a beaucoup de commandes possibles.</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">                Comme le menu est réaffiché instantanément après chaque commande (pour limiter le nombre de commandes à entrer par l&#39;utilisateur qui voudra sûrement afficher plusieurs stats différentes), il faut remonter pour voir les résultats.</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment">                Nous avons choisi d&#39;intégrer ces fonctionnalités directement dans le main car elles sont très spécifiques et on n&#39;y a recours qu&#39;à cet endroit du programme - utiliser des fonctions aurait pu libérer de la place</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">                dans le main, mais aurait compliqué la compréhension et le déboggage du code.</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">            */</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            <span class="keywordflow">if</span>(reafficher_menu_stats) {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                <span class="keywordflow">do</span>{</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                    printf(<span class="stringliteral">&quot;\n\nSTATISTIQUES :\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;                    puts(<span class="stringliteral">&quot;Saisissez l&#39;une des commandes suivantes :&quot;</span>);</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;                        puts(<span class="stringliteral">&quot;\t- &#39;m&#39; pour retourner au menu principal.&quot;</span>);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                        puts(<span class="stringliteral">&quot;\t- &#39;a&#39; pour afficher l&#39;ordre d&#39;arrivee et de sortie des patients ainsi que le temps passe aux urgences.&quot;</span>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                        puts(<span class="stringliteral">&quot;\t- &#39;s&#39; pour afficher le temps d&#39;attente moyen pour chaque salle d&#39;attente&quot;</span>);</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                        puts(<span class="stringliteral">&quot;\t- &#39;o&#39; pour afficher l&#39;ordre de passage des patients dans chaque service&quot;</span>);</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;                        puts(<span class="stringliteral">&quot;\t- &#39;t&#39; pour calculer le temps total, moyen et median passe aux urgences&quot;</span>);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;                        puts(<span class="stringliteral">&quot;\t- &#39;p&#39; pour afficher le pourcentage et la liste de patients ayant emprunte chaque circuit&quot;</span>);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;                        puts(<span class="stringliteral">&quot;\t- &#39;d&#39; pour afficher des statistiques relatives a la duree de chaque tache&quot;</span>);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160; </div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                    fflush(stdin);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;                    scanf(<span class="stringliteral">&quot; %c&quot;</span>,&amp;requete);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                    requete = <a class="code" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a>(requete);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;                    <span class="comment">//le menu prend encore une fois la forme d&#39;une saisie de caractère suivie d&#39;un switch...case..., avec saisie sécurisée.</span></div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                    <span class="keywordflow">switch</span>(requete) {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span> :; <span class="comment">//Le compilateur couine parfois quand le case est suivi d&#39;une affectation, donc dans le doute (si on est amenés à modifier la structure du cas) nous mettons un &#39;;&#39; - empty statement - après le &#39;:&#39; pour avoir la paix</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                        printf(<span class="stringliteral">&quot;\n\nTEMPS D&#39;ATTENTE MOYEN DANS CHAQUE SALLE D&#39;ATTENTE\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                        <span class="comment">/*Permet d&#39;afficher le temps d&#39;attente moyen en jours, heures, minutes et secondes passé dans chaque salle d&#39;attente.</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="comment">                        Celui-ci peut très bien être nul s&#39;il y a peu de patients sur une grande plage horaire - surtout dans les salles 3 et 4 qui ne recoivent pas tous les patients,</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="comment">                        ou astronomique s&#39;il y a un grand nombre de patients sur une petite plage horaire - surtout dans les salles 1 et 2 où tous les patients doivent passer.</span></div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="comment">                        Les traitements sont réalisés au moyen du champ &quot;(double) temps_attente&quot; de chaque salle_dattente, qui contient le temps total attendu par les patients d&#39;une salle, en minutes.</span></div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="comment">                        A la fin du flux, cette durée est divisee par le nombre de patients passe par la salle - il s&#39;agit donc du temps d&#39;attente moyen. Il n&#39;y a plus qu&#39;à l&#39;afficher.</span></div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">                        */</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                        saisie_correcte=<span class="keyword">true</span>; <span class="comment">//la saisie correspond bien à une commande disponible - pas besoin de redemander à l&#39;utilisateur de saisir une commande après le switch.</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                        <span class="keywordtype">double</span> temps_moy;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;4;i++) {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> jours = 0;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> heures=0;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> minutes=0;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> secondes=0;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;                            temps_moy=tableau_salles_attente[i]-&gt;<a class="code" href="structsalle__dattente.html#a40026208a5a928e17470ece9a3fcabde">temps_attente</a>; <span class="comment">/*pendant la simulation, on a enregistré dans chaque salle d&#39;attente le temps (en minutes, réel) attendu par chaque patient quittant la salle et on l&#39;a sommé.</span></div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="comment">                            On disposait donc du temps total d&#39;attente dans la salle d&#39;attente.</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="comment">                            A la fin du flux, nous avons divisé ce temps total d&#39;attente par le nombre de patients passés par là et avons écrasé sda-&gt;temps_attente.</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="comment">                            Nous avons donc déjà le temps moyen d&#39;attente, qu&#39;il suffit d&#39;affecter à temps_moy puis de convertir en heures, minutes et secondes pour affichage dans la console.*/</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                            <span class="comment">//temps moy : temps moyen d&#39;attente dans une sda EN MINUTES (nombre REEL (format avec des secondes adaptés pour une moyenne))</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                            jours = ((int)temps_moy)/1440; <span class="comment">//1440 minutes dans un jour</span></div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                            temps_moy-=1440*jours; <span class="comment">//on retire ensuite tout ce qui est passé dans le compteur de jours</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                            heures = ((int)temps_moy)/60; <span class="comment">//60 minutes dans une heure</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                            temps_moy-=60*heures;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                            minutes = (int)temps_moy;<span class="comment">//il reste entre 0 et 59.999... minutes</span></div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                            temps_moy-=minutes;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                            secondes=(int)(temps_moy*60); <span class="comment">/*il ne reste que les chiffres après la virgule. On multiplie par 60 pour avoir le nombre de secondes. 0.5 minute --&gt; 0.5*60 = 30 secondes*/</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                            printf(<span class="stringliteral">&quot;\tSalle d&#39;attente %d : &quot;</span>,i+1);</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                            <span class="keywordtype">char</span> jplur[3]= {<span class="charliteral">&#39;s&#39;</span>,<span class="charliteral">&#39;,&#39;</span>,<span class="charliteral">&#39;\0&#39;</span>};</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                            <span class="keywordtype">char</span> hplur[3]= {<span class="charliteral">&#39;s&#39;</span>,<span class="charliteral">&#39;,&#39;</span>,<span class="charliteral">&#39;\0&#39;</span>};</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                            <span class="keywordtype">char</span> mplur[3]= {<span class="charliteral">&#39;s&#39;</span>,<span class="charliteral">&#39;\0&#39;</span>,<span class="charliteral">&#39;\0&#39;</span>};</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                            <span class="keywordtype">char</span> splur[3]= {<span class="charliteral">&#39;s&#39;</span>,<span class="charliteral">&#39;.&#39;</span>,<span class="charliteral">&#39;\0&#39;</span>}; <span class="comment">/*gestion des pluriels / singuliers pour éviter d&#39;afficher &quot;1 jours, 1 heures, 1 minutes et 1 secondes&quot;</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="comment">                            on créée une chaîne &quot;s&quot; à mettre à la fin de chaque unité; si il y a exactement une unité, on remplace le &#39;s&#39; par &#39;,&#39;.</span></div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="comment">                            Donc, si singulier, plur contient &quot;,&quot; Sinon, plur contient &quot;s,&quot;.</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="comment">                            On met &#39;\0&#39; au lieu de &#39;,&#39; après les minutes (car suivies d&#39;un &quot;et&quot;).</span></div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="comment">                            Cas particulier : on met &#39;.&#39; au lieu de &#39;,&#39; après les secondes.</span></div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="comment">                            Comme ça, on reste en de bons termes avec Molière.*/</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;                            hplur[0]=(heures==1)?<span class="charliteral">&#39;,&#39;</span>:<span class="charliteral">&#39;s&#39;</span>; hplur[1]=(heures==1)?<span class="charliteral">&#39;\0&#39;</span>:<span class="charliteral">&#39;,&#39;</span>;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                            mplur[0]=(minutes==1)?<span class="charliteral">&#39;\0&#39;</span>:<span class="charliteral">&#39;s&#39;</span>; mplur[1]=(minutes==1)?<span class="charliteral">&#39;\0&#39;</span>:<span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;                            splur[0]=(secondes==1)?<span class="charliteral">&#39;.&#39;</span>:<span class="charliteral">&#39;s&#39;</span>; splur[1]=(secondes==1)?<span class="charliteral">&#39;\0&#39;</span>:<span class="charliteral">&#39;.&#39;</span>;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                            <span class="comment">//Affichage d&#39;un message dépendant des unités de valeur non nulles : on ne veut pas afficher de 0 avant la première unité significative.</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                            <span class="keywordflow">if</span>(jours &gt;0 ){</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                jplur[0]=(jours==1)?<span class="charliteral">&#39;,&#39;</span>:<span class="charliteral">&#39;s&#39;</span>;jplur[1]=(jours==1)?<span class="charliteral">&#39;\0&#39;</span>:<span class="charliteral">&#39;,&#39;</span>;</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                                printf(<span class="stringliteral">&quot;%d jour%s %d heure%s %d minute%s et %d seconde%s&quot;</span>,jours,jplur,heures,hplur,minutes,mplur,secondes,splur);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                            }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(heures&gt;0) {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                printf(<span class="stringliteral">&quot;%d heure%s %d minute%s et %d seconde%s&quot;</span>,heures,hplur,minutes,mplur,secondes,splur);}</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(minutes&gt;0){</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                                printf(<span class="stringliteral">&quot;%d minute%s et %d seconde%s&quot;</span>,minutes,mplur,secondes,splur);}</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(secondes&gt;0){</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                printf(<span class="stringliteral">&quot;%d seconde%s&quot;</span>,secondes,splur);}</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                            <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                printf(<span class="stringliteral">&quot;aucune attente&quot;</span>);}</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                            putchar(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                        }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                        reafficher_menu_stats=<span class="keyword">true</span>; <span class="comment">//et après, on réaffiche le menu des stats.</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span> :;</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                    {</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                        printf(<span class="stringliteral">&quot;\n\nTEMPS PASSE AUX URGENCES :\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                        <span class="comment">/*Statistiques relatives au temps total/moyen/médian passé aux urgences.</span></div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">                        Il est souvent pertinent d&#39;indiquer le temps moyen, très sensible aux valeurs extrêmes, et le temps médian (la moitié des patients a attendu moins longtemps que ce temps, l&#39;autre moitié plus)</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">                        L&#39;écart-type est également une donnée pertinente lorsqu&#39;on commence à avoir beaucoup de patients : il permet de voir s&#39;il existe de grandes disparités entre le temps de traitement des patients.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">                        Les traitements sont faits à partir des heures d&#39;arrivée et de sortie des patients de liste_patients.</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">                        Les fonctions utilisées pour décomposer, recomposer, afficher, et calculer des durées de type &quot;temps&quot; sont définies dans temps.c.</span></div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="comment">                        */</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                        saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                        <a class="code" href="structtemps.html">temps</a> t_total; t_total.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>=t_total.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>=t_total.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>=t_total.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>=t_total.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>=0; <span class="comment">//on créée un &quot;temps nul&quot; auquel on va &quot;additionner&quot; le temps passé par chaque patient.</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                        <a class="code" href="structtemps.html">temps</a> durees[nombre_patients];</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                        <span class="comment">/*On créée des pointeurs ppatientmin et ppatientmax vers les patients ayant respectivement passé le moins et le plus de temps aux urgences.</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">                        On les fait correspondre aux temps tmin et tmax qui auront pris leur valeur finale à la fin de la boucle qui parcourra l&#39;ensemble des patients.*/</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;                        <a class="code" href="structpatient.html">patient</a> *ppatientmin,*ppatientmax;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                        ppatientmin=liste_patients[0]; ppatientmax=liste_patients[nombre_patients-1];</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                        <a class="code" href="structtemps.html">temps</a> tmin, tmax; tmax=t_total; <span class="comment">//on profite du temps total initialisé à des valeurs nulles pour initialiser tmax à des valeurs nulles - même si ce n&#39;est pas très élégant.</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                        tmin = <a class="code" href="temps_8c.html#a1c16374136babbfd5caa30c0aa3ab1e4">diffTemps</a>(liste_patients[0]-&gt;arrivee,liste_patients[0]-&gt;sortie);<span class="comment">//on initialise tmin à la durée correspondant au premier patient de notre liste - on retiendra ensuite les patients pour lesquels la durée de séjour est inférieure.</span></div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> g=0; g&lt;nombre_patients;g++) {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                            ppatient=liste_patients[g];</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                            duree=<a class="code" href="temps_8c.html#a1c16374136babbfd5caa30c0aa3ab1e4">diffTemps</a>(ppatient-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>,ppatient-&gt;<a class="code" href="structpatient.html#add67403d62e2740150bfea38fdf266b9">sortie</a>); <span class="comment">//le temps total passé aux urgences vaut heure de sortie - heure d&#39;arrivée. On calcule cette différence avec la fonction diffTemps et on l&#39;affecte au temps &quot;duree&quot;</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                            <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(duree,tmin)==-1) { <span class="comment">//on a trouvé un temps inférieur à tmin ?</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                                    tmin = duree;               <span class="comment">//on enregistre le nouveau minimum dans tmin</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                    ppatientmin=ppatient;       <span class="comment">//et on retient l&#39;adresse du nouveau patient ayant attendu le moins longtemps dans ppatientmin</span></div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                            }</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                            <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(duree,tmax)==1) { <span class="comment">//on a trouvé un temps supérieur à tmax ?</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                    tmax = duree;               <span class="comment">//on enregistre le nouveau maximum dans tmax</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                    ppatientmax=ppatient;       <span class="comment">//et on retient l&#39;adresse du nouveau patient ayant attendu le plus longtemps dans ppatientmax</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;                            }</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;                            <a class="code" href="temps_8c.html#a7b65ae2942c2ceddaf59b92851278db5">ajouterTemps</a>(&amp;t_total,duree); <span class="comment">//puis on ajoute ce temps au  temps total grâce à la fonction ajouterTemps qui incrémente la valeur du premier paramètre et décrémente le deuxième paramètre jusqu&#39;à ce qu&#39;il soit nul (temps.c)</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;                            durees[g]=duree; <span class="comment">//on met également &quot;duree&quot; dans un tableau de durees pour chaque patient - c&#39;est nécessaire pour retrouver les valeurs extrêmes, l&#39;écart-type et la médiane.</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                        }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                        <a class="code" href="temps_8c.html#a348278859da408a81686c5f6979a8d0e">trierDurees</a>(durees,nombre_patients); <span class="comment">//la fonction trierDurees de temps.c TRIE par ordre de durées croissante le tableau durees. Ce tri est nécessaire pour trouver les valeurs extrêmes et la médiane.</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                        printf(<span class="stringliteral">&quot;\tTotal : &quot;</span>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(t_total,1); <span class="comment">/*La fonction dureeMoyenne de temps.c décompose un temps en minutes, puis le divise par le second paramètre avant de recomposer un temps et de</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="comment">                        l&#39;afficher sous la forme j jours, h heures, m minutes et s secondes - de manière optimisée (pas de 0 avant les valeurs significatives etc). Ici on divise le temps total par 1 - c&#39;est un raccourci.*/</span></div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        printf(<span class="stringliteral">&quot;\tMoyen : &quot;</span>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(t_total,nombre_patients);<span class="comment">//duree moyenne : temps_total(minutes)/nombre_total_patients</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                        printf(<span class="stringliteral">&quot;\tEcart-type (minutes) : %.2lf\n&quot;</span>,<a class="code" href="temps_8c.html#a44b7271f8aaa54fd07c8bc6cc43e0c04">ecart_type</a>(durees,nombre_patients));<span class="comment">/*la fonction ecart-type de temps.c recalcule la moyenne, puis fait la somme des carrés des écarts de chaque élément de durees[] à la moyenne.</span></div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="comment">                        Elle renvoie un nombre réel de minutes.*/</span></div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                        printf(<span class="stringliteral">&quot;\tMedian : &quot;</span>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(durees[(nombre_patients+1)/2-1],1); <span class="comment">/* Le temps médian est celui contenu par la case du milieu - ou celle d&#39;avant la moitié du tableau trié dans le cas d&#39;un nombre pair de patients.</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="comment">                        Exemple : Pour 10 patients, la case choisie sera la cinquieme (durees[4]) : 11/2-1 --&gt; int(5,5)-1 = 4. Un peu plus de la moitié des patients aura attendu plus longtemps que le temps médian.</span></div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="comment">                        Pour 9 patients, on tombe pile sur la cinquième case : 10/2-1--&gt; 4. il y a 4 patients qui auront attendu moins longtemps, et 4 patients qui auront attendu plus longtemps.*/</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                        <span class="keywordflow">if</span>(nombre_patients&gt;1){<span class="comment">//on décide d&#39;afficher les valeurs extrêmes uniquement s&#39;il y a plus d&#39;un patient. Sinon, le minimum et le maximum sont les mêmes.</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                            printf(<span class="stringliteral">&quot;\tMinimal : Patient %d (%s %s) : &quot;</span>,ppatientmin-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatientmin-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatientmin-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(durees[0],1);<span class="comment">//Le temps min sera celui qui se trouvera à la première case.</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                            printf(<span class="stringliteral">&quot;\tMaximal : Patient %d (%s %s) : &quot;</span>,ppatientmax-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatientmax-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatientmax-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(durees[nombre_patients-1],1);<span class="comment">//le temps max sera celui de la dernière case du tableau de durées trié.</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                        }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;                    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;                        <span class="keywordtype">bool</span> afficher_temps_indiv;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                        <span class="keywordflow">if</span>(nombre_patients&gt;=7){ <span class="comment">//s&#39;il y a plus de 7 patients, on laisse le choix à l&#39;utilisateur pour l&#39;affichage des durees individuelles - sinon on pourrait encombrer la console.</span></div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;                            afficher_temps_indiv = <a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;\nVoulez-vous afficher le temps passe aux urgences par chaque patient ?&quot;</span>);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;                        }</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                        <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;                            afficher_temps_indiv=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;                        }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                        <span class="keywordflow">if</span>(afficher_temps_indiv){</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                            printf(<span class="stringliteral">&quot;\nTemps passe aux urgences par chaque patient : \n&quot;</span>);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;nombre_patients; i++){</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                                ppatient=liste_patients[i];</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                                printf(<span class="stringliteral">&quot;\tPatient %3d (%s %s) : &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(<a class="code" href="temps_8c.html#a1c16374136babbfd5caa30c0aa3ab1e4">diffTemps</a>(ppatient-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>,ppatient-&gt;<a class="code" href="structpatient.html#add67403d62e2740150bfea38fdf266b9">sortie</a>),1);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                            }</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                        }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                        reafficher_menu_stats=<span class="keyword">true</span>; <span class="comment">//terminé, affichage du menu des stats.</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;p&#39;</span> :;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                        saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                        printf(<span class="stringliteral">&quot;\n\nSTATISTIQUES RELATIVES AUX CIRCUITS\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                        <span class="comment">/*Cette commande affiche le pourcentage de patients ayant emprunté chaque circuit, ainsi que la liste des patients les ayant empruntés.</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">                        Les traitements sont réalisés à partir de liste_patients, un tableau de patients, et du nombre de patients passé par chaque circuit (nb_patients_cc, nb_patients_cl ...) enregistré avant le flux.*/</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                        <span class="keywordtype">int</span> pourcentage=0; <span class="comment">//nous voulons afficher un pourcentage entier.</span></div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                        <span class="keywordflow">if</span>(nb_patients_cc&gt;0){</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                            pourcentage=100*nb_patients_cc/nombre_patients; <span class="comment">//nombre de patients enregistrés en circuit court sur nombre total de patients. On multiplie ce ratio par 100 et on obtient un pourcentage - arrondi a l&#39;entier inferieur.</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                            printf(<span class="stringliteral">&quot;\nCircuit COURT : %d%% des patients.\n&quot;</span>,(<span class="keywordtype">int</span>)pourcentage);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nombre_patients;i++) {</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                <span class="keywordflow">if</span>(liste_patients[i]-&gt;<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907">circuit</a>==<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ae245e90149daf6036ece3cb84960aab1">COURT</a>) { <span class="comment">//à chaque fois, on parcourt la liste de tous les patients de la simulation et on affiche uniquement ceux qui sont passés dans le circuit concerné.</span></div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                                    printf(<span class="stringliteral">&quot;\tPatient %3d : (%s %s)\n&quot;</span>,liste_patients[i]-&gt;<span class="keywordtype">id</span>,liste_patients[i]-&gt;prenom,liste_patients[i]-&gt;nom); <span class="comment">/*Afin de garder un affichage esthétique (toutes les lignes au même niveau) on utilise tout au long du programme le %3d pour que les</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">                                    numéros de patients à 1 chiffres, 2 chiffres et 3 chiffres prennent la même place dans la chaîne. Nous n&#39;allons pas jusqu&#39;à 4 chiffres car on considère que l&#39;utilisateur n&#39;y aura probablement pas recours - et l&#39;espace affiché serait trop grand*/</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                                }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                            }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                        }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                        <span class="keywordflow">if</span>(nb_patients_cl&gt;0){</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                            pourcentage=100-pourcentage; <span class="comment">//tous les patients qui ne sont pas allés en circuit court sont allés en circuit long.</span></div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                            printf(<span class="stringliteral">&quot;\nCircuit LONG : %d%% des patients.\n&quot;</span>,pourcentage);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nombre_patients;i++) {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                <span class="keywordflow">if</span>(liste_patients[i]-&gt;<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907">circuit</a>==<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ab86309467500740b6a45155702e36424">LONG_SIMPLE</a>) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                                    printf(<span class="stringliteral">&quot;\tPatient %3d : (%s %s)\n&quot;</span>,liste_patients[i]-&gt;<span class="keywordtype">id</span>,liste_patients[i]-&gt;prenom,liste_patients[i]-&gt;nom);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                                }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                            }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;                            <span class="keywordflow">if</span>(nb_patients_cl_cpt&gt;0) {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                                printf(<span class="stringliteral">&quot;\t%d%% ont subi des examens complementaires (%d%% du total).\n&quot;</span>,100*nb_patients_cl_cpt/nb_patients_cl,100*nb_patients_cl_cpt/nombre_patients);</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                                <span class="comment">//On affiche le pourcentage de patients du CL ayant eu des examens complémentaires puis le pourcentage de patients ayant eu un examen complémentaire sur l&#39;ensemble de la simulation.</span></div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;nombre_patients;i++) {</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                                    <span class="keywordflow">if</span>(liste_patients[i]-&gt;<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907">circuit</a>==<a class="code" href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a>) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                                        printf(<span class="stringliteral">&quot;\t\tPatient %3d : (%s %s)\n&quot;</span>,liste_patients[i]-&gt;<span class="keywordtype">id</span>,liste_patients[i]-&gt;prenom,liste_patients[i]-&gt;nom);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                                    }</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;                                }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;                            }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                        }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                        reafficher_menu_stats=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;d&#39;</span> :;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                        saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                        printf(<span class="stringliteral">&quot;\n\nSTATISTIQUES DES TACHES REALISEES\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                        <span class="comment">/*Cette commande affiche, pour chaque salle_even, la durée de séjour des patients ainsi que des statistiques relatives à l&#39;ensemble de ces durees.</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">                        Ces données sont traitées à partir de deux tableaux appartenant aux salle_even :</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">                        un tableau de durées trié par ordre de durées croissantes (tab_durees) et un tableau d&#39;id de patients correspondant (tab_id_patients)*/</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                        <a class="code" href="structtemps.html">temps</a> duree_totale;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;                        <span class="keywordtype">char</span> tache[30];</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> g=0;g&lt;5;g++) {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;                            psalle=tableau_salles_even[g]; <span class="comment">//on considère chaque salle_even parmi le tableau de salles utilisé pour contrôler le flux durant la simulation</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                            <span class="keywordflow">if</span>(psalle==S_ENREG) strcpy(tache,<span class="stringliteral">&quot;Enregistrement&quot;</span>); <span class="comment">//On donne un &quot;titre&quot; à chaque sous-partie, correspondant à la tâche réalisée.</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(psalle==S_EXAMEN_IOA) strcpy(tache,<span class="stringliteral">&quot;Examen IOA&quot;</span>);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(psalle==S_EXAMEN_LONG) strcpy(tache,<span class="stringliteral">&quot;Examen (circuit long)&quot;</span>);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(psalle==S_EXAMEN_COURT) strcpy(tache,<span class="stringliteral">&quot;Examen (circuit court)&quot;</span>);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                            <span class="keywordflow">else</span> strcpy(tache,<span class="stringliteral">&quot;Examen complementaire&quot;</span>);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                            printf(<span class="stringliteral">&quot;%s :\n&quot;</span>,tache);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160; </div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                            <span class="keywordflow">if</span>(psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a> &gt; 1) {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                                duree_totale=<a class="code" href="salles_8c.html#a9051543366ad4f30148d6f16fed26e64">dureeTotale</a>(tableau_salles_even[g]);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                <span class="comment">/*La fonction dureeTotale(salle_even *S) est définie dans salles.c.</span></div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment">                                Elle créée un temps &quot;nul&quot;, lui additionne les durées de séjour de chaque patient entré dans la salle (stockées dans S-&gt;tab_durees) et le retourne.*/</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                printf(<span class="stringliteral">&quot;\tDuree totale : &quot;</span>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(duree_totale,1);</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                                printf(<span class="stringliteral">&quot;\tDuree moyenne : &quot;</span>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(duree_totale,psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;                                <span class="comment">//on divise le temps total par le champ &quot;indice&quot; de la salle_even, qui a été initialisé à 0 et incrémenté à chaque fois qu&#39;un nouveau patient l&#39;occupait - il vaut donc le nombre de patients entrés dans la salle.</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;                                printf(<span class="stringliteral">&quot;\tEcart-type (minutes) : %3.2lf\n&quot;</span>,<a class="code" href="temps_8c.html#a44b7271f8aaa54fd07c8bc6cc43e0c04">ecart_type</a>(psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>,(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <span class="keywordtype">int</span>)psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>));</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                                <span class="comment">//pour l&#39;écart-type, on recalcule la moyenne à partir du tab_durees de la salle, puis la somme des écarts des carrés des valeurs du tableau à cette moyenne. (les durées sont converties en minutes (réelles))</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                                printf(<span class="stringliteral">&quot;\tDuree mediane : &quot;</span>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[(psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>+1)/2-1],1);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                                <span class="comment">//La mediane correspond à l&#39;indice de milieu du tableau tab_durees de la salle -- pour rappel, il a été trié par ordre de durées croissantes après la fin du flux.</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;                                <span class="keywordflow">if</span>(<a class="code" href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a>(psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>-1],psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[0])!=0) { <span class="comment">//si le temps max et le temps min sont différents</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                                    ppatient = <a class="code" href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a>(psalle-&gt;<a class="code" href="structsalle__even.html#aeccb6ff8063926edf565556426c3975b">tab_id_patients</a>[0],liste_patients,nombre_patients);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                    <span class="comment">/*La fonction id_getPatient(unsigned short int ID,patient** liste_patients,int nombre_patients) de patient.c prend en paramètre l&#39;id d&#39;un patient, la liste de tous les patients et sa taille,</span></div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="comment">                                    Et trouve, à partir de cet id, le patient correspondant dans la liste.</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="comment">                                    Ainsi on peut se contenter de stocker les id (int) des patients par ordre de durées de séjour croissantes dans la salle_even*/</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                                    printf(<span class="stringliteral">&quot;\tDuree de la tache pour chaque patient : \n&quot;</span>);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                                    <span class="comment">//comme le tableau tab_durees de la salle est trié, le minimum correspond à la première case et le maximum à la dernière case.</span></div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                                    <span class="comment">/*Les id de patients se trouvent, par ordre de durées croissantes, dans le champ tab_id_patients de la salle.</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="comment">                                    Donc pour le même indice, on peut avoir l&#39;id du patient (dans tab_id_patients) et sa durée de séjour dans la salle (tab_durees)*/</span></div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                                    printf(<span class="stringliteral">&quot;\t\tDuree minimale : Patient %3d : (%s %s) : &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[0],1);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                                    ppatient = <a class="code" href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a>(psalle-&gt;<a class="code" href="structsalle__even.html#aeccb6ff8063926edf565556426c3975b">tab_id_patients</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>-1],liste_patients,nombre_patients);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                    printf(<span class="stringliteral">&quot;\t\tDuree maximale : Patient %3d : (%s %s) : &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>-1],1);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;                                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> h=0;h&lt; psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a>;h++){</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;                                    <span class="comment">//affichage de tous les patients passés par la salle et de leur durée de séjour</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                                    ppatient = <a class="code" href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a>(psalle-&gt;<a class="code" href="structsalle__even.html#aeccb6ff8063926edf565556426c3975b">tab_id_patients</a>[h],liste_patients,nombre_patients);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                                    printf(<span class="stringliteral">&quot;\t\tPatient %3d (%s %s) : &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[h],1);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;                                }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                            }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a> ==1) { <span class="comment">//pas besoin d&#39;afficher toutes ces stats pour un seul patient ! Ce n&#39;est pas intéressant</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                                ppatient = <a class="code" href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a>(psalle-&gt;<a class="code" href="structsalle__even.html#aeccb6ff8063926edf565556426c3975b">tab_id_patients</a>[0],liste_patients,nombre_patients);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                <span class="comment">//Message personnalisé si un seul patient est passé par là</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                printf(<span class="stringliteral">&quot;\tSeul le patient %3d (%s %s) est passe par la %s : &quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>,psalle-&gt;<a class="code" href="structsalle__even.html#ac874262dd5ae0818c46ac185ee7a5b55">message</a>);<a class="code" href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a>(psalle-&gt;<a class="code" href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">tab_durees</a>[0],1);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;                            }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                                <span class="comment">//message personnalisé si la salle n&#39;a accueilli aucun patient.</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                printf(<span class="stringliteral">&quot;\tLa %s n&#39;a pas ete utilisee.\n&quot;</span>,psalle-&gt;<a class="code" href="structsalle__even.html#ac874262dd5ae0818c46ac185ee7a5b55">message</a>);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                            }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;                        }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                        reafficher_menu_stats=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span> :</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                        printf(<span class="stringliteral">&quot;\n\nORDRE DE PASSAGE DANS CHAQUE SERVICE\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                        <span class="comment">/*Cette commande affiche, pour chaque salle_even, les patients entrés dans la salle dans l&#39;ordre. Elle est utile pour faire des vérifications du bon fonctionnement du programme.</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">                        Les patients qui entrent dans une salle_even sont conservés dans son champ &quot;ordre&quot;, tableau de (patient*), qui contient les id des patients qui y sont entres, classe par ordre d&#39;insertion.</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">                        A partir de leur ID et de la liste de tous les patients de la simulation, on peut ensuite recuperer des pointeurs vers les patients correspondants pour afficher leurs données.*/</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;                        <span class="keywordtype">char</span> service[30];<span class="comment">//chaine qui stockera un message personnalisé correspondant à une salle_even</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> g=0;g&lt;5;g++) {</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                            putchar(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                            psalle=tableau_salles_even[g]; <span class="comment">//pour chaque salle du tableau de salles_even ...</span></div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                            <span class="keywordflow">if</span>(psalle==S_ENREG) strcpy(service,<span class="stringliteral">&quot;Enregistrement&quot;</span>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(psalle==S_EXAMEN_IOA) strcpy(service,<span class="stringliteral">&quot;Examen IOA&quot;</span>);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(psalle==S_EXAMEN_LONG) strcpy(service,<span class="stringliteral">&quot;Examen (circuit long)&quot;</span>);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(psalle==S_EXAMEN_COURT) strcpy(service,<span class="stringliteral">&quot;Examen (circuit court)&quot;</span>);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;                            <span class="keywordflow">else</span> strcpy(service,<span class="stringliteral">&quot;Examen complementaire&quot;</span>);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                            printf(<span class="stringliteral">&quot;%s :\n&quot;</span>,service);</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                            <span class="keywordflow">if</span>(psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a> &gt; 0) { <span class="comment">/*Le champ indice valait initialement 0 et a été incrémenté à chaque entrée d&#39;un patient. Il correspond donc à la taille de &quot;ordre&quot;.</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="comment">                                Si plus d&#39;un patient est entré dans la salle ...*/</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i &lt; psalle-&gt;<a class="code" href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">indice</a> ;i++) { <span class="comment">//on parcourt &quot;ordres&quot; pour récupérer l&#39;id de tous les patients qui sont passés par ce service</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                                    ppatient=<a class="code" href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a>(psalle-&gt;<a class="code" href="structsalle__even.html#addccbf4f2a88115bcf8d45e23deaf1c9">ordre</a>[i],liste_patients,nombre_patients); <span class="comment">//la fonction id_getPatient de patient.c permet de récupérer un pointeur vers un patient à partir de son ID et de la liste des patients.</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                                    printf(<span class="stringliteral">&quot;\tPatient %3d (%s %s)\n&quot;</span>,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>); <span class="comment">//affichage du patient</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                                }</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                            }</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                            <span class="keywordflow">else</span> { <span class="comment">//Sinon, càd. si aucun patient n&#39;est entré dans la salle ...</span></div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;                                printf(<span class="stringliteral">&quot;\tAucun patient n&#39;est entre en %s.\n&quot;</span>,psalle-&gt;<a class="code" href="structsalle__even.html#ac874262dd5ae0818c46ac185ee7a5b55">message</a>);<span class="comment">//Message personnalisé</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;                            }</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;                        }</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;                        saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                        reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;                        reafficher_menu_stats=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;a&#39;</span> :</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                        printf(<span class="stringliteral">&quot;\n\nORDRE D&#39;ARRIVEE ET DE SORTIE\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                        <span class="comment">/*Cette commande affiche l&#39;ordre dans lequel les patients sont arrivés et l&#39;heure heure d&#39;arrivée,</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">                        l&#39;ordre dans lequel ils sont sortis et leur heure de sortie, le temps total passé aux urgences pour chaque patient,</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">                        ainsi qu&#39;un message personnalisé si les patients ne sont pas entrés et sortis dans le même ordre.</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="comment">                        */</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                        puts(<span class="stringliteral">&quot;Ordre d&#39;arrivee :&quot;</span>);<span class="comment">//Affichage de l&#39;ordre d&#39;arrivée des patients</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                        <a class="code" href="structtemps.html">temps</a> t;</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                        <span class="keywordtype">char</span> date_prec[11]=<span class="stringliteral">&quot;00/00/0000&quot;</span>; <span class="comment">//chaîne qui retiendra la date d&#39;arrivee ou de sortie précédente pour éviter de l&#39;afficher plusieurs fois</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                        <span class="keywordtype">char</span> date[11];<span class="comment">//chaine qui contiendra la date d&#39;arrivee ou de sortie d&#39;un patient</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                        <span class="keywordtype">char</span> heure[6];<span class="comment">//chaine qui contient l&#39;heure d&#39;arrivee ou de sortie d&#39;un patient.</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                        <span class="keywordtype">bool</span> meme_ordre = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> g=0;g&lt;nombre_patients;g++) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                            ppatient=liste_patients[g]; <span class="comment">//liste_patients contient des ptr vers les patients triés par ordre d&#39;arrivée (triés au prealable par la fonction trierPatients de patient.c).</span></div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                            <span class="comment">//nb : on ne peut pas utiliser les éléments de la queue ENTREE car elle est vidée de ses patients au fur et à mesure qu&#39;ils entrent à l&#39;hôpital</span></div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                            t=ppatient-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>; <span class="comment">//ppatient et t sont des variables intermédiaires servant à simplifier l&#39;affichage des informations concernant les patients et leurs heures d&#39;arrivée et de sortie.</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                            sprintf(date,<span class="stringliteral">&quot;%02d/%02d/%04d&quot;</span>,t.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>,t.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>,t.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>);<span class="comment">//ecriture de la date d&#39;arrivee dans la chaine date</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;                            <span class="keywordflow">if</span>(strcmp(date,date_prec)!=0) {</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                                printf(<span class="stringliteral">&quot;\n\t\tLe %s :\n&quot;</span>,date); <span class="comment">//affichage de la date si changement de date.</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                                strcpy(date_prec,date);         <span class="comment">//enregistrement de la date affichee dans date_prec pour ne pas la reafficher</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                            }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                            sprintf(heure,<span class="stringliteral">&quot;%02d:%02d&quot;</span>,t.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>,t.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>);<span class="comment">//ecriture de l&#39;heure d&#39;arrivee du patient *ppatient dans la chaine heure</span></div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                            printf(<span class="stringliteral">&quot;\t%3d - %s : Patient %3d (%s %s)\n&quot;</span>,g+1,heure,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);<span class="comment">//affichage du rang du patient dans la queue d&#39;entrée, de son heure d&#39;arrivee et de son id + prenom + nom</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;                            <span class="keywordflow">if</span>(meme_ordre&amp;&amp;ppatient != SORTIE-&gt;<a class="code" href="struct_queue.html#a2ba4310ce36c62291da0649db715d60d">elements</a>[g]) {<span class="comment">// si un des patients pris dans l&#39;ordre d&#39;arrivee ne correspond pas au patient de même indice dans la queue de sortie, meme_ordre devient faux et ne peut plus changer.</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                                meme_ordre=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;                            }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                        }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;                        putchar(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;                        puts(<span class="stringliteral">&quot;Ordre de sortie :&quot;</span>);<span class="comment">//affichage de l&#39;ordre de sortie</span></div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;                        strcpy(date_prec,<span class="stringliteral">&quot;00/00/0000&quot;</span>);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> g=0;g&lt;nombre_patients;g++) {</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                            ppatient=SORTIE-&gt;<a class="code" href="struct_queue.html#a2ba4310ce36c62291da0649db715d60d">elements</a>[g]; <span class="comment">//Le champ elements de la queue SORTIE contient des ptr vers les patients classés dans l&#39;ordre où ils ont quitté l&#39;hôpital. On parcourt le tableau dans l&#39;ordre de sortie :</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;                            t=ppatient-&gt;<a class="code" href="structpatient.html#add67403d62e2740150bfea38fdf266b9">sortie</a>;<span class="comment">//l&#39;heure de sortie a été sauvegardée dans le champ &quot;sortie&quot; du patient.</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;                            sprintf(date,<span class="stringliteral">&quot;%02d/%02d/%04d&quot;</span>,t.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>,t.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>,t.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>);<span class="comment">//Comme pour l&#39;ordre d&#39;arrivée, affichage de la date seulement lorsqu&#39;elle ne change pas.</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;                            <span class="keywordflow">if</span>(strcmp(date,date_prec)!=0) {</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;                                printf(<span class="stringliteral">&quot;\n\t\tLe %s :\n&quot;</span>,date);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                                strcpy(date_prec,date);</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;                            }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                            sprintf(heure,<span class="stringliteral">&quot;%02d:%02d&quot;</span>,t.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>,t.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>);</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;                            printf(<span class="stringliteral">&quot;\t%3d - %s : Patient %3d (%s %s).&quot;</span>,g+1,heure,ppatient-&gt;<a class="code" href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">id</a>,ppatient-&gt;<a class="code" href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">prenom</a>,ppatient-&gt;<a class="code" href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">nom</a>);</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                            printf(<span class="stringliteral">&quot; Temps passe aux urgences : &quot;</span>);<span class="comment">//Affichage, avec l&#39;ordre de sortie, duu temps passé aux urgences</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                            t=<a class="code" href="temps_8c.html#a1c16374136babbfd5caa30c0aa3ab1e4">diffTemps</a>(ppatient-&gt;<a class="code" href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">arrivee</a>,ppatient-&gt;<a class="code" href="structpatient.html#add67403d62e2740150bfea38fdf266b9">sortie</a>);<span class="comment">// La fonction diffTemps de temps.c calcule la différence entre deux instants : dans cet appel, la différence entre l&#39;heure de sortie et l&#39;heure d&#39;arrivée.</span></div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;                            <span class="comment">//t correspond donc au temps total passé aux urgences par le patient, de son entrée dans la salle d&#39;enregistrement à son ajout dans la queue SORTIE.</span></div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;                            <span class="keywordflow">if</span>(t.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>&gt;0) printf(<span class="stringliteral">&quot;%dm%dj et %dh%02dmin.&quot;</span>,t.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>,t.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>,t.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>,t.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>); <span class="comment">//affichage personnalise selon les differentes unites non nulles de cette duree</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(t.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>&gt;0) printf(<span class="stringliteral">&quot;%dj et %dh%02dmin.&quot;</span>,t.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>,t.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>,t.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(t.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>&gt;0) printf(<span class="stringliteral">&quot;%dh%02dmin.&quot;</span>,t.<a class="code" href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">h</a>,t.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(t.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>&gt;1) printf(<span class="stringliteral">&quot;%d minutes.&quot;</span>,t.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;                            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(t.<a class="code" href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">m</a>==1) printf(<span class="stringliteral">&quot;1 minute.&quot;</span>);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;                            putchar(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                        }</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                        putchar(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                        <span class="keywordflow">if</span>(nombre_patients&gt;1) {</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;                            <span class="keywordflow">if</span>(meme_ordre)<span class="comment">//Notification de la modification ou non de l&#39;ordre d&#39;arrivée et de sortie des patients.</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;                                puts(<span class="stringliteral">&quot;Les patients sont arrives et repartis des urgences dans le meme ordre.&quot;</span>);</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                puts(<span class="stringliteral">&quot;Les patients ne sont pas arrives et repartis des urgences dans le meme ordre.&quot;</span>);</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                        }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;                        saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                        reafficher_menu=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                        reafficher_menu_stats=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                        <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:<span class="comment">//Cette commande permet de retourner au menu principal.</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                        saisie_correcte=<span class="keyword">true</span>;</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                        reafficher_menu=<span class="keyword">true</span>;<span class="comment">//On reaffiche le menu principal,</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;                        reafficher_menu_stats=<span class="keyword">false</span>;<span class="comment">//on ne reaffiche pas le menu des statistiques</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                        default :</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;                        puts(<span class="stringliteral">&quot;Saisie incorrecte. Veuillez reessayer :&quot;</span>);<span class="comment">//gestion des erreurs de saisie.</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                        saisie_correcte=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;                        }</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;                }<span class="keywordflow">while</span>(!saisie_correcte);<span class="comment">//si saisie_correcte est faux, le programme invite l&#39;utilisateur à saisir de nouveau.</span></div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            }</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            }<span class="keywordflow">while</span>(reafficher_menu_stats);<span class="comment">//reaffichage du menu des statistiques apres chaque commande tant que le caractere &#39;m&#39; n&#39;est pas entree.</span></div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        }<span class="keywordflow">while</span>(reafficher_menu);<span class="comment">//reaffichage du menu principal apres chaque commande ou en sortant du menu des statistiques tant que le caractere &#39;q&#39; n&#39;est pas entre</span></div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160; </div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        <span class="comment">//LIBERATIONS</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;         <span class="keywordflow">if</span>(nombre_patients!=0) {</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="comment">/*On effectue la libération de la majorité des pointeurs vers des segments de taille dynamiquement allouée.</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">        Il faut à chaque fois effectuer des vérifications afin d&#39;éviter de libérer un pointeur de valeur NULL ou un pointeur déjà libéré.*/</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;5;i++) {</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;            <span class="keywordflow">if</span>(tableau_salles_even[i]){</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                <span class="keywordflow">if</span>(tableau_salles_even[i]-&gt;nombre_boxs&gt;0) {</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0;k&lt;tableau_salles_even[i]-&gt;<a class="code" href="structsalle__even.html#acd7d926085aa391de3d07c029210b672">nombre_boxs</a>;k++) {</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                <span class="keywordflow">if</span>(tableau_salles_even[i]-&gt;boxs[k]){</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                    free(tableau_salles_even[i]-&gt;boxs[k]); <span class="comment">//on libère les box des salle_even</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                                }</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                    }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;                }</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                <span class="keywordflow">if</span>(tableau_salles_even[i]-&gt;message){</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                    free(tableau_salles_even[i]-&gt;message); <span class="comment">//ainsi que les messages des salle_even</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                }</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                <span class="keywordflow">if</span>(tableau_salles_even[i]-&gt;indice&gt;0) {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                    free(tableau_salles_even[i]-&gt;tab_id_patients); <span class="comment">//les différents tableaux utilisés pour les statistiques de fin de simulation aussi - si au moins un patient est entré dans la salle, bien sûr</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                    free(tableau_salles_even[i]-&gt;tab_durees);</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                    free(tableau_salles_even[i]-&gt;ordre);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                free(tableau_salles_even[i]); <span class="comment">//puis on libère la salle elle-même</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            }</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160; </div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160; </div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;4;i++) {</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            <span class="keywordflow">if</span>(tableau_salles_attente[i]){</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                free(tableau_salles_attente[i]-&gt;message);free(tableau_salles_attente[i]-&gt;QUEUE-&gt;elements);free(tableau_salles_attente[i]-&gt;QUEUE);free(tableau_salles_attente[i]);</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                <span class="comment">//pour chaque salle d&#39;attente : on libère le message, les patients de la queue, la queue puis la salle d&#39;attente elle-même.</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;        <span class="keywordflow">if</span>(ENTREE){</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;            <span class="keywordflow">if</span>(ENTREE-&gt;<a class="code" href="struct_queue.html#a2ba4310ce36c62291da0649db715d60d">elements</a>){</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;                free(ENTREE-&gt;<a class="code" href="struct_queue.html#a2ba4310ce36c62291da0649db715d60d">elements</a>);<span class="comment">//on libère ensuite les queues d&#39;entrée et de sortie des patients</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;        free(ENTREE);}</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        <span class="keywordflow">if</span>(SORTIE){</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;            <span class="keywordflow">if</span>(SORTIE-&gt;<a class="code" href="struct_queue.html#a2ba4310ce36c62291da0649db715d60d">elements</a>){</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;                free(SORTIE-&gt;<a class="code" href="struct_queue.html#a2ba4310ce36c62291da0649db715d60d">elements</a>);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                }</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;        free(SORTIE);}</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;        <span class="keywordflow">if</span>(liste_patients){</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; nombre_patients ; i++){</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                free(liste_patients[i]);<span class="comment">//Liberation des espaces memoire réservés pour les patients</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            }</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            free(liste_patients);<span class="comment">//libération de la liste de patients elle-même</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    quitter=!<a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="stringliteral">&quot;Voulez-vous commencer une nouvelle simulation ?&quot;</span>);<span class="comment">//Invite l&#39;utilisateur à lancer une nouvelle simulation sans avoir à relancer le programme.</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">if</span>(!quitter){</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        printf(<span class="stringliteral">&quot;\n\nNOUVELLE SIMULATION\n_____________________________________________________________________________________\n%c&quot;</span>,beep);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;        }</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordtype">char</span> beep=<span class="charliteral">&#39;\a&#39;</span>; <span class="comment">//caractère bip sonore</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    putchar(*(&amp;(*(&amp;(*(&amp;(*(&amp;(*(&amp;(*(&amp;(*(&amp;*(&amp;beep)))))))))))))) );<span class="comment">//Bip sonore pour saluer l&#39;utilisateur et rallonger le code</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    printf(<span class="stringliteral">&quot;\nMerci d&#39;avoir utilise ce logiciel. Au revoir.\n&quot;</span>);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;}<span class="comment">//FIN DU MAIN</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"><a class="line" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6"> 1563</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a>(<span class="keywordtype">char</span> c) { <span class="comment">//cette fonction permet de convertir un caractère en minuscules au cas où l&#39;utilisateur l&#39;aurait entrée en majuscules</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordflow">if</span>(c&gt;=<span class="charliteral">&#39;A&#39;</span> &amp;&amp; c&lt;=<span class="charliteral">&#39;Z&#39;</span>)</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <span class="keywordflow">return</span> c+32;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordflow">return</span> c;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;}</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"><a class="line" href="main_8c.html#a8c2aa30c45c2b133140df33e611c7b3f"> 1578</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="main_8c.html#a8c2aa30c45c2b133140df33e611c7b3f">convertir_majuscules</a>(<span class="keywordtype">char</span> c) { <span class="comment">//cette fonction permet de convertir un caractère en majuscules au cas où l&#39;utilisateur l&#39;aurait entré en minuscules</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordflow">if</span>(c&gt;=<span class="charliteral">&#39;a&#39;</span> &amp;&amp; c&lt;=<span class="charliteral">&#39;z&#39;</span>)</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        <span class="keywordflow">return</span> c-32;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">return</span> c;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;}</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"><a class="line" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415"> 1596</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *chaine) { <span class="comment">/*cette fonction permet d&#39;obtenir une reponse positive ou negative de l&#39;utilisateur.</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="comment">    La saisie est sécurisée (nettoyage de la console, répétition de la demande si saisie inattendue).</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="comment">    La chaîne indiquée en paramètre est la question en elle-même.</span></div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="comment">    &quot;Convertit&quot; &#39;o/n&#39; en &#39;true/false&#39; et retourne la variable booléenne correspondante.*/</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    printf(<span class="stringliteral">&quot;%s&quot;</span>,chaine);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    printf(<span class="stringliteral">&quot; (o/n) :\n&quot;</span>); <span class="comment">//affichage de la question suivie d&#39;un &quot;(o/n)&quot; précisant les caractères attendus.</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordtype">char</span> yesno;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="keywordflow">while</span>(1) {</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;        scanf(<span class="stringliteral">&quot; %c&quot;</span>,&amp;yesno);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        yesno=<a class="code" href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a>(yesno);<span class="comment">//rend la saisie insensible à la casse. Permet donc à l&#39;utilisateur de saisir &#39;O&#39; au lieu de &#39;o&#39; par exemple.</span></div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        <span class="keywordflow">switch</span>(yesno) {</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;o&#39;</span>:</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;            fflush(stdin); <span class="comment">//usage de fflush après scanf, au cas où l&#39;utilisateur ait entré plus que prévu et remplisse le prochain scanf.</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;<span class="comment">//on retourne directement le booléen correspondant à la saisie utilisateur.</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160; </div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="keywordflow">case</span> <span class="charliteral">&#39;n&#39;</span>:</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            fflush(stdin);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            puts(<span class="stringliteral">&quot;Entree non valide. Veuillez entrer uniquement \&#39;o\&#39; ou \&#39;n\&#39;.&quot;</span>);<span class="comment">//si caractère inattendu, on réitère la demande.</span></div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        }</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        fflush(stdin);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;}</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"><a class="line" href="main_8c.html#aa9520464888562b1b4662795aac065dc"> 1629</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="main_8c.html#aa9520464888562b1b4662795aac065dc">sauterligne</a>(<span class="keywordtype">bool</span> sauter_une_ligne) {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">if</span>(sauter_une_ligne==<span class="keyword">true</span>) {</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        putchar(<span class="charliteral">&#39;\n&#39;</span>);</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        sauter_une_ligne=<span class="keyword">false</span>;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordflow">return</span> sauter_une_ligne; <span class="comment">//dans tous les cas, vaut faux. On l&#39;affecte au booléen utilisé en paramètre.</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;}</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"><a class="line" href="main_8c.html#a08cbd6d7992729766554608cd096e237"> 1646</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="main_8c.html#a08cbd6d7992729766554608cd096e237">saisirstring</a>(<span class="keywordtype">char</span>* chaine)</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;{</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    fflush(stdin); <span class="comment">//premier nettoyage pour éviter de corrompre la saisie</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    chaine[0]=getchar();</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordflow">while</span>(chaine[i]!=<span class="charliteral">&#39;\n&#39;</span>&amp;&amp;i&lt;40){<span class="comment">//on remplit la chaine de tous les caractères jusqu&#39;à &#39;\n&#39; inclus.</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        i++;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        chaine[i]=getchar();</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    chaine[i]=0; <span class="comment">//on remplace le dernier caractère saisi - ou le dernier de la chaîne - par &#39;\0&#39;.</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    fflush(stdin); <span class="comment">//on tire encore la chasse pour éviter de corrompre les prochaines saisies</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;}</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"><a class="line" href="main_8c.html#a803100da830f55514673d589d01a0a1a"> 1676</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a>(<span class="keywordtype">bool</span> sauter,<a class="code" href="structtemps.html">temps</a> t,<span class="keywordtype">char</span> *descriptif,<span class="keywordtype">char</span> *message_salle,FILE *f)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;{</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordtype">char</span> *heure = <a class="code" href="temps_8c.html#a393c4f6d4fa1d6472d63f7ab94fc7f55">h_to_string</a>(t); <span class="comment">//conversion de l&#39;heure en chaîne hh:mm</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordtype">char</span> message[130]; <span class="comment">//création d&#39;une chaîne qui contiendra le message en entier pour affichage &amp; écriture</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordflow">if</span>(sauter){ <span class="comment">//disjonction de cas : si on a changé d&#39;heure et qu&#39;on veut sauter une ligne, on ajoute un caractère &#39;\n&#39; au début du message.</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;       sprintf(message,<span class="stringliteral">&quot;\n%s : %s%s.\n&quot;</span>,heure,descriptif,message_salle);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    sprintf(message,<span class="stringliteral">&quot;      : %s%s.\n&quot;</span>,descriptif,message_salle);<span class="comment">/* dans la chaîne &quot;message&quot;, on grave l&#39;heure de l&#39;événement,</span></div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="comment">    le descriptif (le patient ... entre en, entre dans la, est pris en charge au ...) et le nom de la salle/du box concerné*/</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    printf(<span class="stringliteral">&quot;%s&quot;</span>,message); <span class="comment">//ecriture du message directement dans la console</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">if</span>(sauter){</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;       sprintf(message,<span class="stringliteral">&quot;\n!%02d/%02d/%04d!%s$ : %s$%s.\n&quot;</span>,t.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>,t.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>,t.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>,heure,descriptif,message_salle); <span class="comment">/*on réécrit une version différente de la chaîne, qui sera cette</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">       fois utilisée pour graver dans le fichier &quot;historique&quot; chaque événement. Il faut ajouter la date à chaque ligne, ainsi que des caractères &#39;!&#39; et &#39;$&#39; pour délimiter les différentes informations,</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">       afin de permettre la lecture des événements pour un seul patient.</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment">       La date au début de chaque ligne sera ignorée, ainsi que les cractères &#39;!&#39; et &#39;$&#39; lors de l&#39;affichage de l&#39;historique au complet.</span></div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment">       Cependant, pour l&#39;historique d&#39;un patient unique, on regardera à chaque fois le numéro du patient contenu dans &quot;descriptif&quot;, et la date contenue entre les deux &#39;!&#39; pour l&#39;afficher si elle change d&#39;un événement à l&#39;autre.*/</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    }</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    sprintf(message,<span class="stringliteral">&quot;!%02d/%02d/%04d!%s$ : %s$%s.\n&quot;</span>,t.<a class="code" href="structtemps.html#a6695e70643be3974198cdc71e0e56368">jour</a>,t.<a class="code" href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">mois</a>,t.<a class="code" href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">annee</a>,heure,descriptif,message_salle);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    }</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordflow">if</span>(f) {</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        fprintf(f,<span class="stringliteral">&quot;%s&quot;</span>,message); <span class="comment">//ecriture dans le fichier (avec des $ pour séparer les parties utiles pour la lecture, et des ! pour mettre la date à chaque ligne).</span></div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        printf(<span class="stringliteral">&quot;ERREUR LORS DE L&#39;ECRITURE DE L&#39;HISTORIQUE.&quot;</span>);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    }</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160; </div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    free(heure);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">/*la fonction retourne systématiquement false, pour indiquer qu&#39;il n&#39;y a plus besoin de sauter une ligne (sauf si le paramètre sauter vaut true).</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="comment">    En effet, nous avons choisi de sauter une ligne uniquement quand l&#39;heure change. Un booléen &quot;changementminute&quot; est utilisé dans le main pour notifier un changement d&#39;heure et appeler un premier saut de ligne.</span></div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="comment">    A chaque fois que l&#39;on affiche le message, on affecte la valeur de retour (false) de cette fonction à &quot;changementminute&quot; pour indiquer qu&#39;il ne faut plus sauter une ligne.</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="comment">    C&#39;est une solution peu élégante mais un bon raccourci pour éviter de compliquer le main. */</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="asalles_8c_html_ab31ca02a82373fd0c38b7dc765017f76"><div class="ttname"><a href="salles_8c.html#ab31ca02a82373fd0c38b7dc765017f76">creerSalleDattente</a></div><div class="ttdeci">salle_dattente * creerSalleDattente(unsigned int maxElements, const char *message)</div><div class="ttdoc">Instancie une salle d'attente d'intitulé donné, capable d'accueillir un nombre donné de patients.</div><div class="ttdef"><b>Definition:</b> <a href="salles_8c_source.html#l00016">salles.c:16</a></div></div>
<div class="ttc" id="astruct_queue_html_a344318fc1db2efc28d3cce1a33702b75"><div class="ttname"><a href="struct_queue.html#a344318fc1db2efc28d3cce1a33702b75">Queue::capacite</a></div><div class="ttdeci">unsigned int capacite</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00008">queue.h:8</a></div></div>
<div class="ttc" id="atemps_8c_html_a8eef0f9e961c61abc041d51a6e68dc07"><div class="ttname"><a href="temps_8c.html#a8eef0f9e961c61abc041d51a6e68dc07">demander_date</a></div><div class="ttdeci">temps demander_date()</div><div class="ttdoc">Demande à l'utilisateur de saisir une date au format jj/mm/aaaa.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00133">temps.c:133</a></div></div>
<div class="ttc" id="atemps_8c_html_a805f024985dcaa7a6bec43095d8990a9"><div class="ttname"><a href="temps_8c.html#a805f024985dcaa7a6bec43095d8990a9">demander_duree</a></div><div class="ttdeci">temps demander_duree()</div><div class="ttdoc">Demande à l'utilisateur de saisir une durée au format hh:mm ou mm.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00013">temps.c:13</a></div></div>
<div class="ttc" id="astructtemps_html_acd9c171bf821cc269d5e398d0ef170a5"><div class="ttname"><a href="structtemps.html#acd9c171bf821cc269d5e398d0ef170a5">temps::h</a></div><div class="ttdeci">unsigned char h</div><div class="ttdef"><b>Definition:</b> <a href="temps_8h_source.html#l00016">temps.h:16</a></div></div>
<div class="ttc" id="apatient_8h_html_a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d"><div class="ttname"><a href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907a3c1eae44baeb152da42ff4576a63913d">LONG_EXAM_CPT</a></div><div class="ttdeci">@ LONG_EXAM_CPT</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00008">patient.h:7</a></div></div>
<div class="ttc" id="atemps_8c_html_a392a56219736519e5abb210ad9f67383"><div class="ttname"><a href="temps_8c.html#a392a56219736519e5abb210ad9f67383">demander_annee_mois</a></div><div class="ttdeci">temps demander_annee_mois()</div><div class="ttdoc">Demande à l'utilisateur de saisir une année et un mois.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00251">temps.c:251</a></div></div>
<div class="ttc" id="asalles_8c_html_a3d6ea999ddfc95a1819d3934e3733b2c"><div class="ttname"><a href="salles_8c.html#a3d6ea999ddfc95a1819d3934e3733b2c">patientsAttendent</a></div><div class="ttdeci">void patientsAttendent(salle_dattente *Salle_Dattente)</div><div class="ttdoc">Ajoute une minute (par patient dans sa file) au temps d'attente total d'une salle d'attente.</div><div class="ttdef"><b>Definition:</b> <a href="salles_8c_source.html#l00139">salles.c:139</a></div></div>
<div class="ttc" id="astruct_queue_html_a2ba4310ce36c62291da0649db715d60d"><div class="ttname"><a href="struct_queue.html#a2ba4310ce36c62291da0649db715d60d">Queue::elements</a></div><div class="ttdeci">patient ** elements</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00010">queue.h:10</a></div></div>
<div class="ttc" id="asalles_8c_html_a219baa22d6a85b830a8b6388b9f6f546"><div class="ttname"><a href="salles_8c.html#a219baa22d6a85b830a8b6388b9f6f546">trierStats</a></div><div class="ttdeci">void trierStats(salle_even *S)</div><div class="ttdoc">Trie conjointement deux tableaux servant à l'établissement de statistiques d'une salle &quot;d'événement&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="salles_8c_source.html#l00195">salles.c:195</a></div></div>
<div class="ttc" id="astructtemps_html_a5c44f70d4d420ccd8bbf3667cac34022"><div class="ttname"><a href="structtemps.html#a5c44f70d4d420ccd8bbf3667cac34022">temps::m</a></div><div class="ttdeci">unsigned char m</div><div class="ttdef"><b>Definition:</b> <a href="temps_8h_source.html#l00017">temps.h:17</a></div></div>
<div class="ttc" id="astructpatient_html_ae23939e83979cbee00774ae75de6ace3"><div class="ttname"><a href="structpatient.html#ae23939e83979cbee00774ae75de6ace3">patient::arrivee</a></div><div class="ttdeci">temps arrivee</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00018">patient.h:18</a></div></div>
<div class="ttc" id="amain_8c_html_aa9520464888562b1b4662795aac065dc"><div class="ttname"><a href="main_8c.html#aa9520464888562b1b4662795aac065dc">sauterligne</a></div><div class="ttdeci">bool sauterligne(bool sauter_une_ligne)</div><div class="ttdoc">F utilisée pour sauter une ligne sous certaines conditions.</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l01629">main.c:1629</a></div></div>
<div class="ttc" id="amain_8c_html_abf0147b9e23c2a83cceca8d28c308415"><div class="ttname"><a href="main_8c.html#abf0147b9e23c2a83cceca8d28c308415">yesno_question</a></div><div class="ttdeci">bool yesno_question(const char *chaine)</div><div class="ttdoc">Fonction utilisée pour obtenir une réponse positive ou négative de l'utilisateur à une question indiq...</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l01596">main.c:1596</a></div></div>
<div class="ttc" id="astructsalle__even_html_ac2341779f151d713968994416d34620c"><div class="ttname"><a href="structsalle__even.html#ac2341779f151d713968994416d34620c">salle_even::d_esperance</a></div><div class="ttdeci">unsigned int d_esperance</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00045">salles.h:45</a></div></div>
<div class="ttc" id="astructpatient_html_a595b073371fbe81581c391db3899dc15"><div class="ttname"><a href="structpatient.html#a595b073371fbe81581c391db3899dc15">patient::duree_examen_complementaire</a></div><div class="ttdeci">temps duree_examen_complementaire</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00020">patient.h:20</a></div></div>
<div class="ttc" id="astructpatient_html_a40ce59616a422a793804d9ef7baa1995"><div class="ttname"><a href="structpatient.html#a40ce59616a422a793804d9ef7baa1995">patient::id</a></div><div class="ttdeci">unsigned int id</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00016">patient.h:16</a></div></div>
<div class="ttc" id="astructsalle__even_html_a4c170acdd626a81fc9de8735494dd23b"><div class="ttname"><a href="structsalle__even.html#a4c170acdd626a81fc9de8735494dd23b">salle_even::boxs</a></div><div class="ttdeci">struct salle_even ** boxs</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00026">salles.h:26</a></div></div>
<div class="ttc" id="aqueue_8c_html_a8754fb0edc8076afe6b6e76995a43c60"><div class="ttname"><a href="queue_8c.html#a8754fb0edc8076afe6b6e76995a43c60">creerQueue</a></div><div class="ttdeci">Queue * creerQueue(unsigned int maxElements)</div><div class="ttdoc">Instancie une queue de capacité maximale donnée, pouvant être utilisée dans la simulation.</div><div class="ttdef"><b>Definition:</b> <a href="queue_8c_source.html#l00017">queue.c:17</a></div></div>
<div class="ttc" id="astructtemps_html"><div class="ttname"><a href="structtemps.html">temps</a></div><div class="ttdef"><b>Definition:</b> <a href="temps_8h_source.html#l00012">temps.h:12</a></div></div>
<div class="ttc" id="asalles_8h_html"><div class="ttname"><a href="salles_8h.html">salles.h</a></div></div>
<div class="ttc" id="astruct_queue_html_a0bf6ad4952ce081299e7eb3c95eeeef4"><div class="ttname"><a href="struct_queue.html#a0bf6ad4952ce081299e7eb3c95eeeef4">Queue::taille</a></div><div class="ttdeci">unsigned int taille</div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00009">queue.h:9</a></div></div>
<div class="ttc" id="atemps_8c_html_ae694ba2fedae28520201167dc56b2495"><div class="ttname"><a href="temps_8c.html#ae694ba2fedae28520201167dc56b2495">comparerTemps</a></div><div class="ttdeci">char comparerTemps(temps temps1, temps temps2)</div><div class="ttdoc">Compare deux valeurs temporelles.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00775">temps.c:775</a></div></div>
<div class="ttc" id="atemps_8c_html_a54f1bd7d22a9598eb010a8ea3152d8ca"><div class="ttname"><a href="temps_8c.html#a54f1bd7d22a9598eb010a8ea3152d8ca">demander_date_heure</a></div><div class="ttdeci">temps demander_date_heure()</div><div class="ttdoc">Demande à l'utilisateur de saisir une date au format jj/mm/aaaa, puis une heure au format hh:mm ou hh...</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00083">temps.c:83</a></div></div>
<div class="ttc" id="aqueue_8c_html_a89840d7ec790d4b8fef47ae3e6120fb6"><div class="ttname"><a href="queue_8c.html#a89840d7ec790d4b8fef47ae3e6120fb6">estVide</a></div><div class="ttdeci">bool estVide(Queue *Q)</div><div class="ttdoc">Test de vacuité d'une Queue.</div><div class="ttdef"><b>Definition:</b> <a href="queue_8c_source.html#l00037">queue.c:37</a></div></div>
<div class="ttc" id="astructpatient_html_a751fe23767dc796135f3bb711a2b9e75"><div class="ttname"><a href="structpatient.html#a751fe23767dc796135f3bb711a2b9e75">patient::nom</a></div><div class="ttdeci">char nom[40]</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00014">patient.h:14</a></div></div>
<div class="ttc" id="amain_8c_html_a803100da830f55514673d589d01a0a1a"><div class="ttname"><a href="main_8c.html#a803100da830f55514673d589d01a0a1a">notifier_evenement</a></div><div class="ttdeci">bool notifier_evenement(bool sauter, temps t, char *descriptif, char *message_salle, FILE *f)</div><div class="ttdoc">Cette fonction permet :</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l01676">main.c:1676</a></div></div>
<div class="ttc" id="asalles_8c_html_abdfaefa1a2ae1288d772d48efc21d02c"><div class="ttname"><a href="salles_8c.html#abdfaefa1a2ae1288d772d48efc21d02c">grouperBoxs</a></div><div class="ttdeci">salle_even ** grouperBoxs(int nombre_boxs,...)</div><div class="ttdoc">Créée un tableau contenant l'adresse de tous les box passés en paramètres d'entrée.</div><div class="ttdef"><b>Definition:</b> <a href="salles_8c_source.html#l00116">salles.c:116</a></div></div>
<div class="ttc" id="astructtemps_html_ab128ebce0d502e4bb757e9e2fc0f2f13"><div class="ttname"><a href="structtemps.html#ab128ebce0d502e4bb757e9e2fc0f2f13">temps::mois</a></div><div class="ttdeci">unsigned char mois</div><div class="ttdef"><b>Definition:</b> <a href="temps_8h_source.html#l00014">temps.h:14</a></div></div>
<div class="ttc" id="astructsalle__dattente_html_a1a1377b2b0551a3465c085e88f0329b0"><div class="ttname"><a href="structsalle__dattente.html#a1a1377b2b0551a3465c085e88f0329b0">salle_dattente::QUEUE</a></div><div class="ttdeci">Queue * QUEUE</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00011">salles.h:11</a></div></div>
<div class="ttc" id="apatient_8h_html_a9f1a14e847c1c237682cd841a9178907ab86309467500740b6a45155702e36424"><div class="ttname"><a href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ab86309467500740b6a45155702e36424">LONG_SIMPLE</a></div><div class="ttdeci">@ LONG_SIMPLE</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00006">patient.h:6</a></div></div>
<div class="ttc" id="aaleatoire_8c_html_aeed8498cbad80a2d4b08e1c78acfd73e"><div class="ttname"><a href="aleatoire_8c.html#aeed8498cbad80a2d4b08e1c78acfd73e">genererDureeTache</a></div><div class="ttdeci">temps genererDureeTache(unsigned int esperance, unsigned int ecart)</div><div class="ttdoc">Génération d'une probabilité et recherche dichotomique de son antécédent par la fonction de répartiti...</div><div class="ttdef"><b>Definition:</b> <a href="aleatoire_8c_source.html#l00018">aleatoire.c:18</a></div></div>
<div class="ttc" id="apatient_8h_html_a9f1a14e847c1c237682cd841a9178907"><div class="ttname"><a href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907">circuit</a></div><div class="ttdeci">circuit</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00004">patient.h:4</a></div></div>
<div class="ttc" id="astructsalle__even_html_acb4ba098870dd6b62fe597bc9b907b96"><div class="ttname"><a href="structsalle__even.html#acb4ba098870dd6b62fe597bc9b907b96">salle_even::indice</a></div><div class="ttdeci">unsigned short int indice</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00040">salles.h:40</a></div></div>
<div class="ttc" id="apatient_8h_html_a9f1a14e847c1c237682cd841a9178907ae245e90149daf6036ece3cb84960aab1"><div class="ttname"><a href="patient_8h.html#a9f1a14e847c1c237682cd841a9178907ae245e90149daf6036ece3cb84960aab1">COURT</a></div><div class="ttdeci">@ COURT</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00005">patient.h:5</a></div></div>
<div class="ttc" id="apatient_8c_html_ad2aea8bcada8be9acd5027784c4545bd"><div class="ttname"><a href="patient_8c.html#ad2aea8bcada8be9acd5027784c4545bd">id_getPatient</a></div><div class="ttdeci">patient * id_getPatient(unsigned short int ID, patient **liste_patients, int nombre_patients)</div><div class="ttdoc">Trouve un patient dans une liste à partir de son ID et renvoie un pointeur vers celui-ci.</div><div class="ttdef"><b>Definition:</b> <a href="patient_8c_source.html#l00024">patient.c:24</a></div></div>
<div class="ttc" id="atemps_8c_html_a1c16374136babbfd5caa30c0aa3ab1e4"><div class="ttname"><a href="temps_8c.html#a1c16374136babbfd5caa30c0aa3ab1e4">diffTemps</a></div><div class="ttdeci">temps diffTemps(temps t1, temps t2)</div><div class="ttdoc">Calcul de la différence entre la plus grande et la plus petite de deux valeurs temporelles.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00706">temps.c:706</a></div></div>
<div class="ttc" id="atemps_8c_html_ab54a9d70f29755a3868cf6df238cff73"><div class="ttname"><a href="temps_8c.html#ab54a9d70f29755a3868cf6df238cff73">demander_jour_heure</a></div><div class="ttdeci">temps demander_jour_heure(unsigned short int annee, unsigned char mois)</div><div class="ttdoc">Demande à l'utilisateur de saisir le jour d'un mois donné et une heure.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00298">temps.c:298</a></div></div>
<div class="ttc" id="amain_8c_html_a8c2aa30c45c2b133140df33e611c7b3f"><div class="ttname"><a href="main_8c.html#a8c2aa30c45c2b133140df33e611c7b3f">convertir_majuscules</a></div><div class="ttdeci">char convertir_majuscules(char c)</div><div class="ttdoc">Convertit une lettre minuscule en lettre majuscule.</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l01578">main.c:1578</a></div></div>
<div class="ttc" id="aqueue_8c_html_acf1baaebc367b53b7a88e9317d77e321"><div class="ttname"><a href="queue_8c.html#acf1baaebc367b53b7a88e9317d77e321">enqueue</a></div><div class="ttdeci">void enqueue(Queue *Q, patient *element)</div><div class="ttdoc">Ajoute l'adresse d'un patient en bout de file dans la Queue souhaitée.</div><div class="ttdef"><b>Definition:</b> <a href="queue_8c_source.html#l00068">queue.c:68</a></div></div>
<div class="ttc" id="astructsalle__even_html_ad5707ffc634e32bc3d1da351a407fc0e"><div class="ttname"><a href="structsalle__even.html#ad5707ffc634e32bc3d1da351a407fc0e">salle_even::salle_suiv</a></div><div class="ttdeci">salle_dattente * salle_suiv</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00025">salles.h:25</a></div></div>
<div class="ttc" id="astructsalle__even_html_a0a7b992c2b0f2981f7fd9f7e15e9bed1"><div class="ttname"><a href="structsalle__even.html#a0a7b992c2b0f2981f7fd9f7e15e9bed1">salle_even::salle_prec</a></div><div class="ttdeci">salle_dattente * salle_prec</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00024">salles.h:24</a></div></div>
<div class="ttc" id="atemps_8c_html_ab43e72c2edbbd3e180e79c9a09a562f7"><div class="ttname"><a href="temps_8c.html#ab43e72c2edbbd3e180e79c9a09a562f7">afficher_date</a></div><div class="ttdeci">void afficher_date(temps t)</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00331">temps.c:331</a></div></div>
<div class="ttc" id="atemps_8c_html_a393c4f6d4fa1d6472d63f7ab94fc7f55"><div class="ttname"><a href="temps_8c.html#a393c4f6d4fa1d6472d63f7ab94fc7f55">h_to_string</a></div><div class="ttdeci">char * h_to_string(temps t)</div><div class="ttdoc">Convertit une heure en une chaîne de caractères de la forme &quot;hh:mm&quot;.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00325">temps.c:325</a></div></div>
<div class="ttc" id="atemps_8c_html_aae393b86938adce806d3b2d3eadc1502"><div class="ttname"><a href="temps_8c.html#aae393b86938adce806d3b2d3eadc1502">estDernierJourMois</a></div><div class="ttdeci">bool estDernierJourMois(temps t)</div><div class="ttdoc">Test de valeur maximale d'un jour pour un mois donné.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00460">temps.c:460</a></div></div>
<div class="ttc" id="atemps_8c_html_a44b7271f8aaa54fd07c8bc6cc43e0c04"><div class="ttname"><a href="temps_8c.html#a44b7271f8aaa54fd07c8bc6cc43e0c04">ecart_type</a></div><div class="ttdeci">double ecart_type(temps *tab_temps, unsigned short int nb)</div><div class="ttdoc">Calcule l'écart-type d'une série statistique durée/individu.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00932">temps.c:932</a></div></div>
<div class="ttc" id="astructpatient_html_acb4e5b72aee77b2e7fa57e3b826a469d"><div class="ttname"><a href="structpatient.html#acb4e5b72aee77b2e7fa57e3b826a469d">patient::circuit</a></div><div class="ttdeci">unsigned char circuit</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00017">patient.h:17</a></div></div>
<div class="ttc" id="astructtemps_html_a6695e70643be3974198cdc71e0e56368"><div class="ttname"><a href="structtemps.html#a6695e70643be3974198cdc71e0e56368">temps::jour</a></div><div class="ttdeci">unsigned char jour</div><div class="ttdef"><b>Definition:</b> <a href="temps_8h_source.html#l00015">temps.h:15</a></div></div>
<div class="ttc" id="astructpatient_html"><div class="ttname"><a href="structpatient.html">patient</a></div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00013">patient.h:13</a></div></div>
<div class="ttc" id="aqueue_8c_html_a768e29a4a002f3c86c06bdbf7420be38"><div class="ttname"><a href="queue_8c.html#a768e29a4a002f3c86c06bdbf7420be38">trierPatients</a></div><div class="ttdeci">Queue * trierPatients(int Nombre_Patients, patient **Liste_Patients)</div><div class="ttdoc">Créée une queue de patients ordonnée par ordre d'arrivée.</div><div class="ttdef"><b>Definition:</b> <a href="queue_8c_source.html#l00141">queue.c:141</a></div></div>
<div class="ttc" id="astructsalle__dattente_html_a40026208a5a928e17470ece9a3fcabde"><div class="ttname"><a href="structsalle__dattente.html#a40026208a5a928e17470ece9a3fcabde">salle_dattente::temps_attente</a></div><div class="ttdeci">double temps_attente</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00012">salles.h:12</a></div></div>
<div class="ttc" id="amain_8c_html_a08cbd6d7992729766554608cd096e237"><div class="ttname"><a href="main_8c.html#a08cbd6d7992729766554608cd096e237">saisirstring</a></div><div class="ttdeci">void saisirstring(char *chaine)</div><div class="ttdoc">Procédure de saisie sécurisée.</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l01646">main.c:1646</a></div></div>
<div class="ttc" id="amain_8c_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdoc">Fonction main : assemble toutes les fonctionnalités du programme.</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l00032">main.c:32</a></div></div>
<div class="ttc" id="astructsalle__dattente_html_af8e31f49164ea2aab080871435024c69"><div class="ttname"><a href="structsalle__dattente.html#af8e31f49164ea2aab080871435024c69">salle_dattente::message</a></div><div class="ttdeci">char * message</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00013">salles.h:13</a></div></div>
<div class="ttc" id="atemps_8c_html_a8b24107fd7a016ba24d107ceafae3e14"><div class="ttname"><a href="temps_8c.html#a8b24107fd7a016ba24d107ceafae3e14">dureeMoyenne</a></div><div class="ttdeci">void dureeMoyenne(temps t, unsigned short int diviseur)</div><div class="ttdoc">Divise un nombre réel de minutes par un effectif et affiche de manière optimisée la valeur temporelle...</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00855">temps.c:855</a></div></div>
<div class="ttc" id="astructsalle__even_html_a279393d3d7f82148a5445e705c245978"><div class="ttname"><a href="structsalle__even.html#a279393d3d7f82148a5445e705c245978">salle_even::tab_durees</a></div><div class="ttdeci">temps * tab_durees</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00037">salles.h:37</a></div></div>
<div class="ttc" id="astructsalle__even_html_acd7d926085aa391de3d07c029210b672"><div class="ttname"><a href="structsalle__even.html#acd7d926085aa391de3d07c029210b672">salle_even::nombre_boxs</a></div><div class="ttdeci">unsigned char nombre_boxs</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00029">salles.h:29</a></div></div>
<div class="ttc" id="astructsalle__even_html_a37d63c15b777b1bffbef60a14612f213"><div class="ttname"><a href="structsalle__even.html#a37d63c15b777b1bffbef60a14612f213">salle_even::libre</a></div><div class="ttdeci">bool libre</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00023">salles.h:23</a></div></div>
<div class="ttc" id="astructpatient_html_add67403d62e2740150bfea38fdf266b9"><div class="ttname"><a href="structpatient.html#add67403d62e2740150bfea38fdf266b9">patient::sortie</a></div><div class="ttdeci">temps sortie</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00019">patient.h:19</a></div></div>
<div class="ttc" id="astructsalle__even_html_a06592682cd4b93e991b5b70a38539c68"><div class="ttname"><a href="structsalle__even.html#a06592682cd4b93e991b5b70a38539c68">salle_even::Patient</a></div><div class="ttdeci">patient * Patient</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00031">salles.h:31</a></div></div>
<div class="ttc" id="astructsalle__even_html_a3a63b88ebbc9060b566fb17c820c78f6"><div class="ttname"><a href="structsalle__even.html#a3a63b88ebbc9060b566fb17c820c78f6">salle_even::heure_liberation</a></div><div class="ttdeci">temps heure_liberation</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00030">salles.h:30</a></div></div>
<div class="ttc" id="astructsalle__even_html"><div class="ttname"><a href="structsalle__even.html">salle_even</a></div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00022">salles.h:22</a></div></div>
<div class="ttc" id="astructpatient_html_a44ef26afa01c407b90e0ef0474266e4b"><div class="ttname"><a href="structpatient.html#a44ef26afa01c407b90e0ef0474266e4b">patient::prenom</a></div><div class="ttdeci">char prenom[40]</div><div class="ttdef"><b>Definition:</b> <a href="patient_8h_source.html#l00015">patient.h:15</a></div></div>
<div class="ttc" id="atemps_8c_html_a348278859da408a81686c5f6979a8d0e"><div class="ttname"><a href="temps_8c.html#a348278859da408a81686c5f6979a8d0e">trierDurees</a></div><div class="ttdeci">void trierDurees(temps *tab_temps, int nb)</div><div class="ttdoc">Trie un tableau contenant des valeurs temporelles dans l'ordre croissant.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00957">temps.c:957</a></div></div>
<div class="ttc" id="atemps_8c_html_aca1b475930a200a027ff12bb4a2f5960"><div class="ttname"><a href="temps_8c.html#aca1b475930a200a027ff12bb4a2f5960">diffTemps_minutes</a></div><div class="ttdeci">unsigned int diffTemps_minutes(temps t1, temps t2)</div><div class="ttdoc">Calcul de la différence entre la plus grande et la plus petite de deux valeurs temporelles,...</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00740">temps.c:740</a></div></div>
<div class="ttc" id="astructsalle__even_html_ae86fcb20ed2991c56dfaa3d11cce1358"><div class="ttname"><a href="structsalle__even.html#ae86fcb20ed2991c56dfaa3d11cce1358">salle_even::d_ecart</a></div><div class="ttdeci">unsigned int d_ecart</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00046">salles.h:46</a></div></div>
<div class="ttc" id="asalles_8c_html_a647c9b0bb00267b3c8220f143f1892f4"><div class="ttname"><a href="salles_8c.html#a647c9b0bb00267b3c8220f143f1892f4">creerSalleEven</a></div><div class="ttdeci">salle_even * creerSalleEven(const char *message, salle_dattente *Salle_Prec, salle_dattente *Salle_Suiv, unsigned int nombre_patients, unsigned int D_Esperance, unsigned int D_Ecart, salle_even **Boxs, unsigned char Nombre_Boxs)</div><div class="ttdoc">Instancie une salle d'examen ou la salle d'enregistrement.</div><div class="ttdef"><b>Definition:</b> <a href="salles_8c_source.html#l00049">salles.c:49</a></div></div>
<div class="ttc" id="atemps_8c_html_a11b9c21874a289b500069369701e1bf1"><div class="ttname"><a href="temps_8c.html#a11b9c21874a289b500069369701e1bf1">incrementerTemps</a></div><div class="ttdeci">void incrementerTemps(temps *t)</div><div class="ttdoc">Ajout d'une minute à une valeur temporelle en conservant une expression de la date et de l'heure vali...</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00561">temps.c:561</a></div></div>
<div class="ttc" id="amain_8c_html_a586965760b87ba8d7f17a7d8b21ef9f6"><div class="ttname"><a href="main_8c.html#a586965760b87ba8d7f17a7d8b21ef9f6">convertir_minuscules</a></div><div class="ttdeci">char convertir_minuscules(char c)</div><div class="ttdoc">Convertit une lettre majuscule en lettre majuscule.</div><div class="ttdef"><b>Definition:</b> <a href="main_8c_source.html#l01563">main.c:1563</a></div></div>
<div class="ttc" id="asalles_8c_html_a3c356fda632f22019265eb76e6f11cdf"><div class="ttname"><a href="salles_8c.html#a3c356fda632f22019265eb76e6f11cdf">creerBox</a></div><div class="ttdeci">salle_even * creerBox(const char *message)</div><div class="ttdoc">Instancie un nouveau box d'examen.</div><div class="ttdef"><b>Definition:</b> <a href="salles_8c_source.html#l00088">salles.c:88</a></div></div>
<div class="ttc" id="astructsalle__even_html_aeccb6ff8063926edf565556426c3975b"><div class="ttname"><a href="structsalle__even.html#aeccb6ff8063926edf565556426c3975b">salle_even::tab_id_patients</a></div><div class="ttdeci">unsigned short int * tab_id_patients</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00038">salles.h:38</a></div></div>
<div class="ttc" id="atemps_8c_html_a7b65ae2942c2ceddaf59b92851278db5"><div class="ttname"><a href="temps_8c.html#a7b65ae2942c2ceddaf59b92851278db5">ajouterTemps</a></div><div class="ttdeci">void ajouterTemps(temps *t1, temps t2)</div><div class="ttdoc">Calcul de la somme de deux valeurs temporelles et stockage du résultat à l'adresse de la première.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00683">temps.c:683</a></div></div>
<div class="ttc" id="aqueue_8c_html_a50c657862cadc709779c65dddfb4b661"><div class="ttname"><a href="queue_8c.html#a50c657862cadc709779c65dddfb4b661">dequeue</a></div><div class="ttdeci">void dequeue(Queue *Q)</div><div class="ttdoc">Retire l'adresse d'un patient en tête de file d'une Queue.</div><div class="ttdef"><b>Definition:</b> <a href="queue_8c_source.html#l00099">queue.c:99</a></div></div>
<div class="ttc" id="asalles_8c_html_a9051543366ad4f30148d6f16fed26e64"><div class="ttname"><a href="salles_8c.html#a9051543366ad4f30148d6f16fed26e64">dureeTotale</a></div><div class="ttdeci">temps dureeTotale(salle_even *S)</div><div class="ttdoc">Fait le total des durées contenues dans le tableau de durées d'une salle.</div><div class="ttdef"><b>Definition:</b> <a href="salles_8c_source.html#l00227">salles.c:227</a></div></div>
<div class="ttc" id="apatient_8c_html_a80e7249dcf2eace5c4978ab68b3714e0"><div class="ttname"><a href="patient_8c.html#a80e7249dcf2eace5c4978ab68b3714e0">genererPatients</a></div><div class="ttdeci">patient ** genererPatients(unsigned int nb_patients, temps debut_plage_horaire, temps fin_plage_horaire)</div><div class="ttdoc">Instancie un certain nombre de patients et leur attribue une heure d'arrivée comprise dans une plage ...</div><div class="ttdef"><b>Definition:</b> <a href="patient_8c_source.html#l00152">patient.c:152</a></div></div>
<div class="ttc" id="astructsalle__even_html_ac874262dd5ae0818c46ac185ee7a5b55"><div class="ttname"><a href="structsalle__even.html#ac874262dd5ae0818c46ac185ee7a5b55">salle_even::message</a></div><div class="ttdeci">char * message</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00032">salles.h:32</a></div></div>
<div class="ttc" id="apatient_8c_html_a872f83f436fc70d41fdf37405165d107"><div class="ttname"><a href="patient_8c.html#a872f83f436fc70d41fdf37405165d107">creerPatient</a></div><div class="ttdeci">patient * creerPatient()</div><div class="ttdoc">Instancie un nouveau patient dans la simulation.</div><div class="ttdef"><b>Definition:</b> <a href="patient_8c_source.html#l00009">patient.c:9</a></div></div>
<div class="ttc" id="atemps_8c_html_a3eb0b4e2216d80cb4b835c3e7ef6955b"><div class="ttname"><a href="temps_8c.html#a3eb0b4e2216d80cb4b835c3e7ef6955b">demander_heure</a></div><div class="ttdeci">temps demander_heure()</div><div class="ttdoc">Demande à l'utilisateur de saisir une heure au format hh:mm ou hh.</div><div class="ttdef"><b>Definition:</b> <a href="temps_8c_source.html#l00176">temps.c:176</a></div></div>
<div class="ttc" id="astructsalle__dattente_html"><div class="ttname"><a href="structsalle__dattente.html">salle_dattente</a></div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00010">salles.h:10</a></div></div>
<div class="ttc" id="astructtemps_html_a1ede4e95d65a084e89673520a97a84e6"><div class="ttname"><a href="structtemps.html#a1ede4e95d65a084e89673520a97a84e6">temps::annee</a></div><div class="ttdeci">unsigned short int annee</div><div class="ttdef"><b>Definition:</b> <a href="temps_8h_source.html#l00013">temps.h:13</a></div></div>
<div class="ttc" id="aqueue_8c_html_a17b98cf7a290240aca595fa0462803d6"><div class="ttname"><a href="queue_8c.html#a17b98cf7a290240aca595fa0462803d6">element_debut_queue</a></div><div class="ttdeci">patient * element_debut_queue(Queue *Q)</div><div class="ttdoc">Fournit l'élément en tête de file.</div><div class="ttdef"><b>Definition:</b> <a href="queue_8c_source.html#l00052">queue.c:52</a></div></div>
<div class="ttc" id="asalles_8c_html_a23e22b98fc1f218ca1bf80e1c597212e"><div class="ttname"><a href="salles_8c.html#a23e22b98fc1f218ca1bf80e1c597212e">ajouterPatientSalleDattente</a></div><div class="ttdeci">void ajouterPatientSalleDattente(salle_dattente *Salle_Dattente, patient *Patient)</div><div class="ttdoc">Ajoute l'adresse d'un patient la queue d'une salle d'attente (en bout de file).</div><div class="ttdef"><b>Definition:</b> <a href="salles_8c_source.html#l00165">salles.c:165</a></div></div>
<div class="ttc" id="astructsalle__even_html_addccbf4f2a88115bcf8d45e23deaf1c9"><div class="ttname"><a href="structsalle__even.html#addccbf4f2a88115bcf8d45e23deaf1c9">salle_even::ordre</a></div><div class="ttdeci">unsigned short int * ordre</div><div class="ttdef"><b>Definition:</b> <a href="salles_8h_source.html#l00039">salles.h:39</a></div></div>
<div class="ttc" id="apatient_8c_html_aec675c6b3fe32ec2a1cf9e7e20b1cd81"><div class="ttname"><a href="patient_8c.html#aec675c6b3fe32ec2a1cf9e7e20b1cd81">nommerPatients</a></div><div class="ttdeci">void nommerPatients(unsigned int nb_patients, patient **liste_patients)</div><div class="ttdoc">Nomme tous les patients d'une liste à partir des noms et prénoms contenus dans un fichier texte.</div><div class="ttdef"><b>Definition:</b> <a href="patient_8c_source.html#l00042">patient.c:42</a></div></div>
<div class="ttc" id="astruct_queue_html"><div class="ttname"><a href="struct_queue.html">Queue</a></div><div class="ttdef"><b>Definition:</b> <a href="queue_8h_source.html#l00007">queue.h:7</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
